<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Booking - I ‚ù§Ô∏è Miami Concierge</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/flatpickr/dist/flatpickr.min.css">
    <script src="https://cdn.jsdelivr.net/npm/flatpickr" defer></script>
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&family=Playfair+Display:wght@700&display=swap" rel="stylesheet" />
    <style>
      :root { /* CSS Variables */
          --color-gold: #B08D57;
          --color-gold-dark: #9A7B4F;
          --color-teal: #00A09A;
          --color-teal-dark: #00807A;
          --color-teal-light-bg: #f0fdfa;
          --color-palm-green: #3CB371;
      }
      body { font-family: 'Inter', sans-serif; color: #1f2937; }
      h1, h2, h3, .font-playfair { font-family: 'Playfair Display', serif; }
      .brand-gradient-text { background: linear-gradient(to right, #f97316, #ef4444); -webkit-background-clip: text; background-clip: text; color: transparent; font-weight: 700; }
      select { appearance: none; -webkit-appearance: none; -moz-appearance: none; background-image: url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="2" stroke="%2300A09A" class="w-5 h-5"><path stroke-linecap="round" stroke-linejoin="round" d="m19.5 8.25-7.5 7.5-7.5-7.5" /></svg>'); background-repeat: no-repeat; background-position: right 0.75rem center; background-size: 1.25em; padding-right: 2.5rem; }
      /* Tab Styling */
      .tab-button.active-tab {
          background-color: white;
          border-left-color: #e5e7eb;
          border-right-color: #e5e7eb;
          border-top-color: #e5e7eb;
          border-bottom-color: transparent;
          color: var(--color-teal);
          font-weight: 600;
      }
      .tab-button:not(.active-tab) {
          background-color: #f9fafb;
          border-color: transparent;
          color: #6b7280;
      }
      .tab-button:not(.active-tab):hover {
          background-color: #f3f4f6;
          color: #4b5563;
      }
      /* Flatpickr Custom Styles */
      .flatpickr-calendar {
        background: white;
        border-radius: 0.5rem;
        box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06);
      }
       /* Screen Reader Only utility */
       .sr-only {
         position: absolute;
         width: 1px;
         height: 1px;
         padding: 0;
         margin: -1px;
         overflow: hidden;
         clip: rect(0, 0, 0, 0);
         white-space: nowrap;
         border-width: 0;
       }
    </style>
  </head>
  <body class="bg-gray-100">
    <header class="bg-white border-b border-gray-200">
      <nav class="container mx-auto flex h-16 items-center justify-between px-4 sm:px-6 lg:px-8">
        <div><a href="index.html" class="text-3xl font-bold text-gray-900"> I ‚ù§Ô∏è <span class="brand-gradient-text">Miami</span> </a></div>
        <div><span class="mr-4 text-gray-600">Welcome, [Name]!</span><a href="#" class="text-sm font-medium text-[--color-gold] hover:text-[--color-gold-dark]">Logout</a></div>
      </nav>
    </header>

    <main class="container mx-auto px-4 py-8 sm:px-6 lg:px-8">
      <div class="mr-auto w-full max-w-lg">
        <div class="overflow-hidden rounded-xl bg-white shadow-md">
          <div id="tab-navigation" class="border-b border-gray-200">
            <nav class="-mb-px flex" aria-label="Tabs" role="tablist">
              <button type="button" id="tab-button-oneway" data-tab-target="#panel-oneway" class="tab-button w-1/2 whitespace-nowrap py-4 px-1 border-t border-l border-r border-b-2 text-sm text-center rounded-tl-xl" role="tab" aria-selected="true" aria-controls="panel-oneway">One Way</button>
              <button type="button" id="tab-button-experience-plus" data-tab-target="#panel-experience-plus" class="tab-button w-1/2 whitespace-nowrap py-4 px-1 border-t border-l border-r border-b-2 text-sm text-center rounded-tr-xl" role="tab" aria-selected="false" aria-controls="panel-experience-plus">Experience +</button>
            </nav>
          </div>

          <div class="p-6 md:p-8">
            <form action="#" method="POST" id="booking-form" class="space-y-3">

              <div class="relative">
                <label for="from-location" class="absolute -top-2 left-2 inline-block bg-white px-1 text-xs font-medium text-gray-500">From</label>
                <span class="absolute top-1/2 left-3 h-4 w-4 -translate-y-1/2 text-[--color-teal]"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor"><path d="M12 11.5A2.5 2.5 0 0 1 9.5 9A2.5 2.5 0 0 1 12 6.5A2.5 2.5 0 0 1 14.5 9a2.5 2.5 0 0 1-2.5 2.5M12 2a7 7 0 0 0-7 7c0 5.25 7 13 7 13s7-7.75 7-13a7 7 0 0 0-7-7Z"></path></svg></span>
                <input type="text" name="from-location" id="from-location" required aria-describedby="from-location-error" class="block w-full rounded-md border-0 py-3 pr-3 pl-12 text-gray-900 ring-1 ring-gray-300 ring-inset placeholder:text-gray-400 focus:ring-2 focus:ring-[--color-gold] focus:ring-inset sm:text-sm sm:leading-6" placeholder="Address, airport, hotel, ..." />
                <span id="from-location-error" class="mt-1 block text-xs text-red-600 hidden"></span>
              </div>

              <div class="tab-panels space-y-3 pt-2">

                <div id="panel-oneway" class="tab-panel space-y-3" role="tabpanel" tabindex="0" aria-labelledby="tab-button-oneway">
                  <div id="to-address-container" class="relative">
                    <label for="to-address" class="absolute -top-2 left-2 inline-block bg-white px-1 text-xs font-medium text-gray-500">To</label>
                    <span class="absolute top-1/2 left-3 h-4 w-4 -translate-y-1/2 text-[--color-teal]"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor"><path d="M12 11.5A2.5 2.5 0 0 1 9.5 9A2.5 2.5 0 0 1 12 6.5A2.5 2.5 0 0 1 14.5 9a2.5 2.5 0 0 1-2.5 2.5M12 2a7 7 0 0 0-7 7c0 5.25 7 13 7 13s7-7.75 7-13a7 7 0 0 0-7-7Z"></path></svg></span>
                    <input type="text" name="to-address" id="to-address" aria-describedby="to-address-error" class="block w-full rounded-md border-0 py-3 pr-3 pl-12 text-gray-900 ring-1 ring-gray-300 ring-inset placeholder:text-gray-400 focus:ring-2 focus:ring-[--color-gold] focus:ring-inset sm:text-sm sm:leading-6" placeholder="Address, airport, hotel, ..." />
                    <span id="to-address-error" class="mt-1 block text-xs text-red-600 hidden"></span>
                  </div>
                  <div id="date-time-container-oneway" class="relative space-y-1">
                    <div>
                      <label for="pickup-date-oneway" class="block text-xs font-medium text-gray-500 mb-0.5">Date</label>
                      <input type="text" name="pickup-date-oneway" id="pickup-date-oneway" required aria-describedby="pickup-date-oneway-error" class="block w-full rounded-md border-0 py-3 px-3 text-gray-900 ring-1 ring-inset ring-gray-300 focus:ring-2 focus:ring-[--color-gold] sm:text-sm" placeholder="Select Date..." />
                      <span id="pickup-date-oneway-error" class="mt-1 block text-xs text-red-600 hidden"></span>
                    </div>
                    <div>
                      <label for="pickup-time-oneway" class="block text-xs font-medium text-gray-500 mb-0.5">Time</label>
                      <input type="text" name="pickup-time-oneway" id="pickup-time-oneway" required aria-describedby="pickup-time-oneway-error" class="block w-full rounded-md border-0 py-3 px-3 text-gray-900 ring-1 ring-inset ring-gray-300 focus:ring-2 focus:ring-[--color-gold] sm:text-sm" placeholder="Select Time..." />
                      <span id="pickup-time-oneway-error" class="mt-1 block text-xs text-red-600 hidden"></span>
                    </div>
                  </div>
                </div>
                <div id="panel-experience-plus" class="tab-panel space-y-3 hidden" role="tabpanel" tabindex="0" aria-labelledby="tab-button-experience-plus">
                  <div id="experience-dropdown-container" class="relative">
                    <label for="experience-dropdown" class="absolute -top-2 left-2 inline-block bg-white px-1 text-xs font-medium text-gray-500">Select Service</label>
                    <span class="absolute top-1/2 left-3 h-4 w-4 -translate-y-1/2 text-[--color-teal]"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor"><path d="M12 17.27L18.18 21l-1.64-7.03L22 9.24l-7.19-.61L12 2 9.19 8.63 2 9.24l5.46 4.73L5.82 21 12 17.27Z"></path></svg></span>
                    <select name="experience-dropdown" id="experience-dropdown" required aria-describedby="experience-dropdown-error" class="block w-full rounded-md border-0 py-3 pr-3 pl-12 text-gray-900 ring-1 ring-gray-300 ring-inset placeholder:text-gray-400 focus:ring-2 focus:ring-[--color-gold] focus:ring-inset sm:text-sm sm:leading-6">
                      <option value="">-- Choose Service --</option>
                      <option value="hourly_chauffeur">Hourly Chauffeur</option>
                      <option value="water_sky">Ultimate Miami Water & Sky</option>
                      <option value="wynwood_night">Wynwood Art & Culinary Night</option>
                      <option value="everglades">Everglades Adventure</option>
                      <option value="keys_escape">Keys Escape Experience</option>
                    </select>
                    <span id="experience-dropdown-error" class="mt-1 block text-xs text-red-600 hidden"></span>
                  </div>

                  <div id="hourly-description" class="hidden text-sm text-gray-600 bg-gray-50 p-3 rounded-md border border-gray-200">
                     Ideal for business meetings, tourist visits, and multiple stop trips. Gives you flexibility and control over your schedule.
                   </div>

                  <div id="duration-container" class="relative hidden">
                    <label for="duration-hourly" class="absolute -top-2 left-2 inline-block bg-white px-1 text-xs font-medium text-gray-500">Duration</label>
                    <span class="absolute top-1/2 left-3 h-4 w-4 -translate-y-1/2 text-[--color-teal]"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor"><path d="M12 2A10 10 0 0 0 2 12a10 10 0 0 0 10 10a10 10 0 0 0 10-10A10 10 0 0 0 12 2Zm4.2 14.2L11 13V7h1.5v5.2l4.5 2.7-.8 1.3Z"></path></svg></span>
                    <select name="duration-hourly" id="duration-hourly" required aria-describedby="duration-hourly-error" class="block w-full rounded-md border-0 py-3 pr-3 pl-12 text-gray-900 ring-1 ring-gray-300 ring-inset placeholder:text-gray-400 focus:ring-2 focus:ring-[--color-gold] focus:ring-inset sm:text-sm sm:leading-6">
                      <option value="2">2 hours</option><option value="3">3 hours</option><option value="4">4 hours</option><option value="5">5 hours</option><option value="6">6 hours</option><option value="7">7 hours</option><option value="8">8 hours</option><option value="9">9 hours</option><option value="10">10 hours</option><option value="11">11 hours</option><option value="12">12 hours</option>
                    </select>
                    <span id="duration-hourly-error" class="mt-1 block text-xs text-red-600 hidden"></span>
                  </div>

                  <div id="date-time-container-hourly" class="relative hidden space-y-1">
                    <div>
                      <label for="pickup-date-hourly" class="block text-xs font-medium text-gray-500 mb-0.5">Date</label>
                      <input type="text" name="pickup-date-hourly" id="pickup-date-hourly" required aria-describedby="pickup-date-hourly-error" class="block w-full rounded-md border-0 py-3 px-3 text-gray-900 ring-1 ring-inset ring-gray-300 focus:ring-2 focus:ring-[--color-gold] sm:text-sm" placeholder="Select Date..." />
                      <span id="pickup-date-hourly-error" class="mt-1 block text-xs text-red-600 hidden"></span>
                    </div>
                    <div>
                      <label for="pickup-time-hourly" id="pickup-time-label-hourly" class="block text-xs font-medium text-gray-500 mb-0.5">Start Time</label>
                      <input type="text" name="pickup-time-hourly" id="pickup-time-hourly" required aria-describedby="pickup-time-hourly-error" class="block w-full rounded-md border-0 py-3 px-3 text-gray-900 ring-1 ring-inset ring-gray-300 focus:ring-2 focus:ring-[--color-gold] sm:text-sm" placeholder="Select Start Time..." />
                      <span id="pickup-time-hourly-error" class="mt-1 block text-xs text-red-600 hidden"></span>
                    </div>
                  </div>

                  <div id="date-preference-container" class="relative hidden pt-2">
                    <label class="block text-sm font-medium text-gray-700 mb-1" id="date-preference-label">Preferred Timing</label>
                    <fieldset aria-labelledby="date-preference-label" aria-describedby="date-preference-error">
                      <legend class="sr-only">Select Preferred Timing</legend>
                      <div class="flex flex-wrap gap-x-4 gap-y-2">
                        <div class="flex items-center"><input id="pref-asap" name="date_preference" type="radio" value="ASAP / Next Day" class="h-4 w-4 border-gray-300 text-[--color-teal] focus:ring-[--color-teal]"><label for="pref-asap" class="ml-2 block text-sm text-gray-900">ASAP / Next Day</label></div>
                        <div class="flex items-center"><input id="pref-weekend" name="date_preference" type="radio" value="This Coming Weekend" class="h-4 w-4 border-gray-300 text-[--color-teal] focus:ring-[--color-teal]"><label for="pref-weekend" class="ml-2 block text-sm text-gray-900">This Coming Weekend</label></div>
                        <div class="flex items-center"><input id="pref-weekday" name="date_preference" type="radio" value="Next Week (Mon-Fri)" class="h-4 w-4 border-gray-300 text-[--color-teal] focus:ring-[--color-teal]"><label for="pref-weekday" class="ml-2 block text-sm text-gray-900">Next Week (Mon-Fri)</label></div>
                        <div class="flex items-center"><input id="pref-flexible" name="date_preference" type="radio" value="Flexible / Other Date" checked class="h-4 w-4 border-gray-300 text-[--color-teal] focus:ring-[--color-teal]"><label for="pref-flexible" class="ml-2 block text-sm text-gray-900">Flexible / Other Date</label></div>
                      </div>
                    </fieldset>
                    <span id="date_preference-error" class="mt-1 block text-xs text-red-600 hidden"></span>
                  </div>

                  <div id="common-experience-fields" class="hidden space-y-4 border-t border-gray-200 pt-4">
                    <h5 class="text-sm font-semibold text-gray-700">Your Contact Details & Guests</h5>
                    <div class="grid grid-cols-1 gap-x-4 gap-y-5 sm:grid-cols-2">
                      <div class="relative">
                        <label for="experience-name" class="absolute -top-2 left-2 inline-block bg-white px-1 text-xs font-medium text-gray-500">Your Name</label>
                        <input type="text" name="name" id="experience-name" required aria-describedby="experience-name-error" class="block w-full rounded-md border-0 py-3 px-3 text-gray-900 ring-1 ring-inset ring-gray-300 focus:ring-2 focus:ring-[--color-gold] sm:text-sm" />
                        <span id="experience-name-error" class="mt-1 block text-xs text-red-600 hidden"></span>
                      </div>
                      <div class="relative">
                        <label for="experience-guests" class="absolute -top-2 left-2 inline-block bg-white px-1 text-xs font-medium text-gray-500">Number of Guests</label>
                        <input type="number" name="guests" id="experience-guests" required min="1" value="2" aria-describedby="experience-guests-error" class="block w-full rounded-md border-0 py-3 px-3 text-gray-900 ring-1 ring-inset ring-gray-300 focus:ring-2 focus:ring-[--color-gold] sm:text-sm" />
                        <span id="experience-guests-error" class="mt-1 block text-xs text-red-600 hidden"></span>
                      </div>
                      <div class="relative">
                        <label for="experience-email" class="absolute -top-2 left-2 inline-block bg-white px-1 text-xs font-medium text-gray-500">Email</label>
                        <input type="email" name="email" id="experience-email" required aria-describedby="experience-email-error" class="block w-full rounded-md border-0 py-3 px-3 text-gray-900 ring-1 ring-inset ring-gray-300 focus:ring-2 focus:ring-[--color-gold] sm:text-sm" />
                        <span id="experience-email-error" class="mt-1 block text-xs text-red-600 hidden"></span>
                      </div>
                      <div class="relative">
                        <label for="experience-phone" class="absolute -top-2 left-2 inline-block bg-white px-1 text-xs font-medium text-gray-500">Phone</label>
                        <input type="tel" name="phone" id="experience-phone" required aria-describedby="experience-phone-error" class="block w-full rounded-md border-0 py-3 px-3 text-gray-900 ring-1 ring-inset ring-gray-300 focus:ring-2 focus:ring-[--color-gold] sm:text-sm" />
                        <span id="experience-phone-error" class="mt-1 block text-xs text-red-600 hidden"></span>
                      </div>
                    </div>
                  </div>

                  <div id="experience-options-container" class="hidden space-y-4">
                    <!-- Water Sky Options -->
                    <div id="water-sky-options" class="hidden relative border-t border-gray-200 pt-4">
                    </div>
                    <!-- Wynwood (Specific Fields Only) -->
                    <div id="wynwood-night-options" class="hidden space-y-4 border-t border-gray-200 pt-4">
                      <div class="space-y-4">
                        <div>
                          <label class="mb-2 block text-sm font-medium text-gray-900" id="motivation-label">What's the occasion for this experience?</label>
                          <fieldset aria-labelledby="motivation-label" aria-describedby="motivation-error">
                            <legend class="sr-only">Select Occasion</legend>
                            <div class="grid grid-cols-2 gap-3 sm:grid-cols-4">
                              <label for="motivation-romantic" class="flex cursor-pointer items-center justify-center rounded-md border border-gray-300 bg-white p-3 text-sm font-medium text-gray-700 hover:bg-gray-50 has-[:checked]:border-[--color-teal] has-[:checked]:ring-1 has-[:checked]:ring-[--color-teal]">
                                <input type="radio" name="motivation" value="Romantic" id="motivation-romantic" class="sr-only">
                                <span class="flex items-center"><span class="mr-1.5 text-lg">‚ù§Ô∏è</span> Romantic</span>
                              </label>
                              <label for="motivation-celebration" class="flex cursor-pointer items-center justify-center rounded-md border border-gray-300 bg-white p-3 text-sm font-medium text-gray-700 hover:bg-gray-50 has-[:checked]:border-[--color-teal] has-[:checked]:ring-1 has-[:checked]:ring-[--color-teal]">
                                <input type="radio" name="motivation" value="Birthday/Celebration" id="motivation-celebration" class="sr-only">
                                <span class="flex items-center"><span class="mr-1.5 text-lg">üéâ</span> Celebration</span>
                              </label>
                              <label for="motivation-business" class="flex cursor-pointer items-center justify-center rounded-md border border-gray-300 bg-white p-3 text-sm font-medium text-gray-700 hover:bg-gray-50 has-[:checked]:border-[--color-teal] has-[:checked]:ring-1 has-[:checked]:ring-[--color-teal]">
                                <input type="radio" name="motivation" value="Business/Corporate" id="motivation-business" class="sr-only">
                                <span class="flex items-center"><span class="mr-1.5 text-lg">üíº</span> Business</span>
                              </label>
                              <label for="motivation-fun" class="flex cursor-pointer items-center justify-center rounded-md border border-gray-300 bg-white p-3 text-sm font-medium text-gray-700 hover:bg-gray-50 has-[:checked]:border-[--color-teal] has-[:checked]:ring-1 has-[:checked]:ring-[--color-teal]">
                                <input type="radio" name="motivation" value="Friends Night Out / Fun" id="motivation-fun" class="sr-only">
                                <span class="flex items-center"><span class="mr-1.5 text-lg">ü•≥</span> Fun / Friends</span>
                              </label>
                            </div>
                          </fieldset>
                          <span id="motivation-error" class="mt-1 block text-xs text-red-600 hidden"></span>
                        </div>
                      </div>
                      <div class="space-y-4 pt-4 border-t border-gray-200">
                        <h5 class="text-sm font-semibold text-gray-700" id="dinner-preference-label">Dinner Preferences</h5>
                        <div>
                          <fieldset class="mt-1" aria-labelledby="dinner-preference-label" aria-describedby="dinner_style_preference-error">
                            <legend class="sr-only">Dinner Style Preference</legend>
                            <div class="flex flex-wrap gap-x-4 gap-y-2">
                              <div class="flex items-center"><input id="wynwood-dinner-vibrant" name="dinner_style_preference" type="radio" value="Vibrant Scene & Global Flavors" checked class="h-4 w-4 border-gray-300 text-[--color-teal] focus:ring-[--color-teal]" /><label for="wynwood-dinner-vibrant" class="ml-2 block text-sm text-gray-900">Vibrant Scene & Global Flavors</label></div>
                              <div class="flex items-center"><input id="wynwood-dinner-steak" name="dinner_style_preference" type="radio" value="Upscale Steakhouse" class="h-4 w-4 border-gray-300 text-[--color-teal] focus:ring-[--color-teal]" /><label for="wynwood-dinner-steak" class="ml-2 block text-sm text-gray-900">Upscale Steakhouse</label></div>
                              <div class="flex items-center"><input id="wynwood-dinner-modern" name="dinner_style_preference" type="radio" value="Modern American / European" class="h-4 w-4 border-gray-300 text-[--color-teal] focus:ring-[--color-teal]" /><label for="wynwood-dinner-modern" class="ml-2 block text-sm text-gray-900">Modern American / European</label></div>
                              <div class="flex items-center"><input id="wynwood-dinner-italian" name="dinner_style_preference" type="radio" value="Elevated Italian / Mediterranean" class="h-4 w-4 border-gray-300 text-[--color-teal] focus:ring-[--color-teal]" /><label for="wynwood-dinner-italian" class="ml-2 block text-sm text-gray-900">Elevated Italian / Mediterranean</label></div>
                              <div class="flex items-center"><input id="wynwood-dinner-seafood" name="dinner_style_preference" type="radio" value="Iconic Miami Seafood" class="h-4 w-4 border-gray-300 text-[--color-teal] focus:ring-[--color-teal]" /><label for="wynwood-dinner-seafood" class="ml-2 block text-sm text-gray-900">Iconic Miami Seafood</label></div>
                              <div class="flex items-center"><input id="wynwood-dinner-other-style" name="dinner_style_preference" type="radio" value="Other" class="h-4 w-4 border-gray-300 text-[--color-teal] focus:ring-[--color-teal]" /><label for="wynwood-dinner-other-style" class="ml-2 block text-sm text-gray-900">Other (Specify)</label></div>
                            </div>
                          </fieldset>
                          <span id="dinner_style_preference-error" class="mt-1 block text-xs text-red-600 hidden"></span>
                        </div>
                        <div id="wynwood-other-restaurant-container" class="relative hidden">
                          <label for="wynwood-other-restaurant" class="absolute -top-2 left-2 inline-block bg-white px-1 text-xs font-medium text-gray-500">Other Cuisine / Restaurant Request</label>
                          <input type="text" name="other_restaurant_request" id="wynwood-other-restaurant" class="block w-full rounded-md border-0 py-3 px-3 text-gray-900 ring-1 ring-inset ring-gray-300 focus:ring-2 focus:ring-[--color-gold] sm:text-sm" placeholder="e.g., Italian, specific restaurant name" />
                        </div>
                      </div>
                      <div class="space-y-1 pt-4 border-t border-gray-200">
                        <h5 class="text-sm font-semibold text-gray-700" id="lounge-interest-label">Post-Dinner Lounge/Bar</h5>
                        <div>
                          <fieldset class="mt-1" aria-labelledby="lounge-interest-label" aria-describedby="lounge_interest-error">
                            <legend class="sr-only">Post-Dinner Option</legend>
                            <div class="flex flex-wrap gap-3">
                              <div class="flex items-center"><input id="wynwood-lounge-yes" name="lounge_interest" type="radio" value="Yes" class="h-4 w-4 border-gray-300 text-[--color-teal] focus:ring-[--color-teal]" /><label for="wynwood-lounge-yes" class="ml-2 block text-sm text-gray-900">Yes</label></div>
                              <div class="flex items-center"><input id="wynwood-lounge-no" name="lounge_interest" type="radio" value="No" checked class="h-4 w-4 border-gray-300 text-[--color-teal] focus:ring-[--color-teal]" /><label for="wynwood-lounge-no" class="ml-2 block text-sm text-gray-900">No</label></div>
                              <div class="flex items-center"><input id="wynwood-lounge-maybe" name="lounge_interest" type="radio" value="Maybe - Discuss" class="h-4 w-4 border-gray-300 text-[--color-teal] focus:ring-[--color-teal]" /><label for="wynwood-lounge-maybe" class="ml-2 block text-sm text-gray-900">Maybe (Discuss)</label></div>
                            </div>
                          </fieldset>
                          <span id="lounge_interest-error" class="mt-1 block text-xs text-red-600 hidden"></span>
                        </div>
                      </div>
                    </div>
                    <!-- Everglades Options -->
                    <div id="everglades-options" class="hidden relative border-t border-gray-200 pt-4">
                    </div>
                    <!-- Keys Escape Options -->
                    <div id="keys-escape-options" class="hidden relative border-t border-gray-200 pt-4">
                    </div>
                  </div>
                </div>
              </div>

              <div id="notes-container" class="relative">
                <label for="notes" class="absolute -top-2 left-2 inline-block bg-white px-1 text-xs font-medium text-gray-500">Notes / Preferences</label>
                <textarea name="notes" id="notes" rows="3" aria-describedby="notes-error" class="block w-full rounded-md border-0 py-3 px-3 text-gray-900 ring-1 ring-gray-300 ring-inset placeholder:text-gray-400 focus:ring-2 focus:ring-[--color-gold] focus:ring-inset sm:text-sm sm:leading-6" placeholder="Optional notes or preferences..."></textarea>
                <span id="notes-error" class="mt-1 block text-xs text-red-600 hidden"></span>
              </div>

              <div>
                <button type="submit" id="submit-button" class="mt-4 flex w-full items-center justify-center rounded-lg border border-transparent bg-[--color-gold] px-4 py-3 text-lg font-semibold text-white shadow-sm transition duration-300 hover:bg-[--color-gold-dark] focus:ring-2 focus:ring-[--color-gold] focus:ring-offset-2 focus:outline-none disabled:opacity-75">
                  <span class="spinner hidden mr-2"><svg class="animate-spin h-5 w-5 text-white" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24"><circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4"></circle><path class="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"></path></svg></span>
                  <span class="button-text">Get Quote</span>
                </button>
                <span id="submit-button-error" class="mt-1 block text-xs text-red-600 hidden"></span>
              </div>
            </form>

            <div id="confirmation-message" class="hidden text-center mt-6">
              <h3 class="font-playfair text-xl text-gray-900">Thank You!</h3>
              <p class="text-gray-600">Your request has been submitted successfully. We'll get back to you soon.</p>
            </div>
          </div>
        </div>
      </div>
    </main>

    <script>
      document.addEventListener('DOMContentLoaded', () => {
        // --- Configuration ---
        const config = {
          FORM_ENDPOINT: "YOUR_FORMSPREE_ENDPOINT", // Replace with your endpoint
          MAX_NOTES_LENGTH: 500,
          placeholders: {
            oneWay: "Optional: Add flight number, luggage details, or specific instructions...",
            hourly: "Optional: Describe your ideal route, planned stops, music/AC preferences...",
            experience: "Optional: Any special interests or requests for this experience?",
            defaultExp: "Optional notes or preferences..."
          }
        };

        // --- Element References ---
        function getElementRefs() {
          const refs = {};
          refs.bookingForm = document.getElementById('booking-form');
          refs.tabNavigationContainer = document.getElementById('tab-navigation');
          refs.tabNavigationButtons = refs.tabNavigationContainer?.querySelectorAll('.tab-button');
          refs.formTabPanels = refs.bookingForm?.querySelectorAll('.tab-panel');
          refs.fromLocationInput = document.getElementById('from-location');
          refs.notesInput = document.getElementById('notes');
          refs.oneWayPanel = document.getElementById('panel-oneway');
          refs.toAddressInput = document.getElementById('to-address');
          refs.oneWayPickupDateInput = document.getElementById('pickup-date-oneway');
          refs.oneWayPickupTimeInput = document.getElementById('pickup-time-oneway');
          refs.experiencePlusPanel = document.getElementById('panel-experience-plus');
          refs.serviceDropdown = document.getElementById('experience-dropdown');
          refs.hourlyDescription = document.getElementById('hourly-description');
          refs.durationContainer = document.getElementById('duration-container');
          refs.durationSelect = document.getElementById('duration-hourly');
          refs.hourlyDateTimeContainer = document.getElementById('date-time-container-hourly');
          refs.hourlyPickupDateInput = document.getElementById('pickup-date-hourly');
          refs.hourlyPickupTimeInput = document.getElementById('pickup-time-hourly');
          refs.hourlyPickupTimeLabel = document.getElementById('pickup-time-label-hourly');
          refs.datePreferenceContainer = document.getElementById('date-preference-container');
          refs.experienceOptionsContainer = document.getElementById('experience-options-container');
          refs.commonExperienceFieldsContainer = document.getElementById('common-experience-fields');
          refs.experienceNameInput = document.getElementById('experience-name');
          refs.experienceGuestsInput = document.getElementById('experience-guests');
          refs.experienceEmailInput = document.getElementById('experience-email');
          refs.experiencePhoneInput = document.getElementById('experience-phone');
          refs.wynwoodNightOptions = document.getElementById('wynwood-night-options');
          refs.wynwoodDinnerPrefRadios = document.querySelectorAll('#wynwood-night-options input[name="dinner_style_preference"]');
          refs.wynwoodOtherRestaurantContainer = document.getElementById('wynwood-other-restaurant-container');
          refs.wynwoodOtherDinnerRadio = document.getElementById('wynwood-dinner-other-style');
          refs.submitButton = document.getElementById('submit-button');
          refs.submitButtonText = refs.submitButton?.querySelector('.button-text');
          refs.submitButtonSpinner = refs.submitButton?.querySelector('.spinner');
          refs.confirmationMessage = document.getElementById('confirmation-message');
          // Refs for other experience option divs
          refs.waterSkyOptions = document.getElementById('water-sky-options');
          refs.evergladesOptions = document.getElementById('everglades-options');
          refs.keysEscapeOptions = document.getElementById('keys-escape-options');
          return refs;
        }

        // --- Initialize Flatpickr ---
        function initializeFlatpickr(elements) {
          if (!flatpickr) { console.error("Flatpickr library not loaded."); return; }
          const commonDateConfig = { altInput: true, altFormat: "D, M j, Y", dateFormat: "Y-m-d", enableTime: false };
          const commonTimeConfig = { enableTime: true, noCalendar: true, dateFormat: "H:i", altInput: true, altFormat: "h : i K", time_24hr: false, minuteIncrement: 10 };
          if (elements.oneWayPickupDateInput) flatpickr(elements.oneWayPickupDateInput, commonDateConfig);
          if (elements.oneWayPickupTimeInput) flatpickr(elements.oneWayPickupTimeInput, commonTimeConfig);
          if (elements.hourlyPickupDateInput) flatpickr(elements.hourlyPickupDateInput, commonDateConfig);
          if (elements.hourlyPickupTimeInput) flatpickr(elements.hourlyPickupTimeInput, commonTimeConfig);
          console.log("Flatpickr initialized.");
        }

        // --- Helper Functions ---
        function showError(elements, fieldId, message) {
          const errorSpanId = `${fieldId}-error`;
          const errorSpan = document.getElementById(errorSpanId);
          const inputElement = document.getElementById(fieldId);
          let labelText = fieldId;
          const labelElement = document.querySelector(`label[for="${fieldId}"]`);
          if (labelElement) { labelText = labelElement.textContent.replace('*', '').trim(); }
          const fullMessage = `${labelText}: ${message}`;

          if (errorSpan) {
            errorSpan.textContent = fullMessage;
            errorSpan.classList.remove('hidden');
          } else { console.warn(`Error span not found for ID: ${errorSpanId}`); }

          if (inputElement && ['INPUT', 'SELECT', 'TEXTAREA'].includes(inputElement.tagName)) {
            inputElement.classList.add('ring-red-500', 'ring-1');
            inputElement.setAttribute('aria-invalid', 'true');
            if (!inputElement.getAttribute('aria-describedby')) { inputElement.setAttribute('aria-describedby', errorSpanId); }
          } else {
            const radioGroup = document.querySelector(`input[name="${fieldId}"]`);
            if (radioGroup) {
              const fieldset = radioGroup.closest('fieldset');
              if (fieldset) {
                fieldset.classList.add('ring-red-500', 'ring-1', 'rounded');
                fieldset.setAttribute('aria-describedby', `${fieldId.replace(/-/g, '_')}-error`);
              }
            } else { console.warn(`Could not find input/radio group for fieldId: ${fieldId} to apply error state.`); }
          }
        }

        function clearError(fieldId) {
          const errorSpanId = `${fieldId}-error`;
          const errorSpan = document.getElementById(errorSpanId) || document.getElementById(`${fieldId.replace(/-/g, '_')}-error`);
          const inputElement = document.getElementById(fieldId);

          if (errorSpan) { errorSpan.textContent = ''; errorSpan.classList.add('hidden'); }

          if (inputElement && ['INPUT', 'SELECT', 'TEXTAREA'].includes(inputElement.tagName)) {
            inputElement.classList.remove('ring-red-500', 'ring-1');
            inputElement.removeAttribute('aria-invalid');
          } else {
            const radioGroup = document.querySelector(`input[name="${fieldId}"]`);
            if (radioGroup) {
              const fieldset = radioGroup.closest('fieldset');
              if (fieldset) {
                fieldset.classList.remove('ring-red-500', 'ring-1', 'rounded');
                fieldset.removeAttribute('aria-describedby');
              }
            }
          }
        }

        function clearAllErrors(elements) {
          const errorSpans = elements.bookingForm?.querySelectorAll('[id$="-error"]');
          errorSpans?.forEach(span => { span.textContent = ''; span.classList.add('hidden'); });
          const errorInputs = elements.bookingForm?.querySelectorAll('.ring-red-500');
          errorInputs?.forEach(el => el.classList.remove('ring-red-500', 'ring-1', 'rounded'));
          elements.bookingForm?.querySelectorAll('[aria-invalid="true"]').forEach(el => el.removeAttribute('aria-invalid'));
          elements.bookingForm?.querySelectorAll('fieldset[aria-describedby]').forEach(el => el.removeAttribute('aria-describedby'));
        }

        function determineButtonText(elements) {
          let activePanelId = '';
          elements.formTabPanels?.forEach(panel => { if (!panel.classList.contains('hidden')) activePanelId = `#${panel.id}`; });
          const selectedService = elements.serviceDropdown?.value || '';
          if (activePanelId === '#panel-oneway') return 'Get Quote';
          else if (activePanelId === '#panel-experience-plus') {
            if (selectedService === 'hourly_chauffeur') return 'Request Hourly Service';
            else if (selectedService !== '') return 'Request Experience';
            else return 'Select Service';
          }
          return 'Submit';
        }

        function resetSubmitButton(elements) {
          if (!elements.submitButton) return;
          elements.submitButton.disabled = false;
          if (elements.submitButtonSpinner) elements.submitButtonSpinner.classList.add('hidden');
          if (elements.submitButtonText) {
            elements.submitButtonText.textContent = determineButtonText(elements);
            elements.submitButtonText.classList.remove('hidden');
          }
        }

        function setLoadingButton(elements) {
          if (!elements.submitButton) return;
          elements.submitButton.disabled = true;
          if (elements.submitButtonText) elements.submitButtonText.classList.add('hidden');
          if (elements.submitButtonSpinner) elements.submitButtonSpinner.classList.remove('hidden');
        }

        function handleWynwoodDinnerChoice(elements) {
          if (!elements.wynwoodOtherDinnerRadio || !elements.wynwoodOtherRestaurantContainer) return;
          elements.wynwoodOtherRestaurantContainer.classList.toggle('hidden', !elements.wynwoodOtherDinnerRadio.checked);
        }

        // --- UI Update Functions ---
        function updateExperiencePlusPanelUI(elements, placeholders) {
          if (!elements.experiencePlusPanel || elements.experiencePlusPanel.classList.contains('hidden')) return;
          const selectedValue = elements.serviceDropdown.value;
          const showHourly = selectedValue === 'hourly_chauffeur';
          const showCuratedExperience = selectedValue !== '' && !showHourly;

          elements.durationContainer?.classList.toggle('hidden', !showHourly);
          elements.hourlyDateTimeContainer?.classList.toggle('hidden', !showHourly);
          elements.datePreferenceContainer?.classList.toggle('hidden', !showCuratedExperience);
          elements.experienceOptionsContainer?.classList.toggle('hidden', !showCuratedExperience);
          elements.hourlyDescription?.classList.toggle('hidden', !showHourly);
          elements.commonExperienceFieldsContainer?.classList.toggle('hidden', !showCuratedExperience);

          if (elements.notesInput) {
            if (showHourly) elements.notesInput.placeholder = placeholders.hourly;
            else if (showCuratedExperience) elements.notesInput.placeholder = placeholders.experience;
            else elements.notesInput.placeholder = placeholders.defaultExp;
          }

          if (elements.hourlyPickupTimeLabel) elements.hourlyPickupTimeLabel.textContent = "Start Time";

          const allExperienceOptionDivs = [elements.wynwoodNightOptions, elements.waterSkyOptions, elements.evergladesOptions, elements.keysEscapeOptions];
          if (showCuratedExperience && elements.experienceOptionsContainer) {
            allExperienceOptionDivs.forEach(el => el?.classList.add('hidden'));
            if (selectedValue === 'wynwood_night' && elements.wynwoodNightOptions) { elements.wynwoodNightOptions.classList.remove('hidden'); handleWynwoodDinnerChoice(elements); }
            else if (selectedValue === 'water_sky' && elements.waterSkyOptions) elements.waterSkyOptions.classList.remove('hidden');
            else if (selectedValue === 'everglades' && elements.evergladesOptions) elements.evergladesOptions.classList.remove('hidden');
            else if (selectedValue === 'keys_escape' && elements.keysEscapeOptions) elements.keysEscapeOptions.classList.remove('hidden');
          } else {
            allExperienceOptionDivs.forEach(el => el?.classList.add('hidden'));
            if (elements.wynwoodOtherRestaurantContainer) elements.wynwoodOtherRestaurantContainer.classList.add('hidden');
          }
          resetSubmitButton(elements);
        }

        function switchTab(targetPanelId, elements, placeholders) {
          elements.formTabPanels?.forEach(panel => panel.classList.add('hidden'));
          elements.tabNavigationButtons?.forEach(button => {
            button.classList.remove('active-tab');
            button.setAttribute('aria-selected', 'false');
            button.removeAttribute('tabindex');
          });

          const targetPanel = document.querySelector(targetPanelId);
          const targetButton = elements.tabNavigationContainer?.querySelector(`[data-tab-target="${targetPanelId}"]`);
          let firstFocusableElement = null;

          if (targetPanel) {
            targetPanel.classList.remove('hidden');
            firstFocusableElement = targetPanel.querySelector('input:not([type="hidden"]), select, textarea, button:not([disabled])');
          }
          if (targetButton) {
            targetButton.classList.add('active-tab');
            targetButton.setAttribute('aria-selected', 'true');
            targetButton.setAttribute('tabindex', '0');
          }

          if (elements.notesInput) {
            if (targetPanelId === '#panel-oneway') {
              elements.notesInput.placeholder = placeholders.oneWay;
              elements.commonExperienceFieldsContainer?.classList.add('hidden');
              elements.durationContainer?.classList.add('hidden');
              elements.hourlyDateTimeContainer?.classList.add('hidden');
              elements.datePreferenceContainer?.classList.add('hidden');
              elements.experienceOptionsContainer?.classList.add('hidden');
              elements.hourlyDescription?.classList.add('hidden');
            } else if (targetPanelId === '#panel-experience-plus') {
              updateExperiencePlusPanelUI(elements, placeholders);
              firstFocusableElement = elements.serviceDropdown || firstFocusableElement;
            }
          }

          setTimeout(() => { if (firstFocusableElement) firstFocusableElement.focus(); }, 0);
          resetSubmitButton(elements);
          clearAllErrors(elements);
        }

        // --- Form Validation ---
        function validateForm(elements) {
          let isValid = true;
          let serviceType = '';
          let activePanelId = '';
          elements.formTabPanels.forEach(panel => { if (!panel.classList.contains('hidden')) activePanelId = `#${panel.id}`; });
          const selectedService = elements.serviceDropdown.value;

          // Rule 1: From Location
          if (!elements.fromLocationInput?.value.trim()) { showError(elements, 'from-location', 'Please enter a "From" location.'); isValid = false; }

          // Rule 2: Tab-Specific
          if (activePanelId === '#panel-oneway') {
            serviceType = 'One Way';
            if (!elements.toAddressInput?.value.trim()) { showError(elements, 'to-address', 'Please enter a "To" address.'); isValid = false; }
            if (!elements.oneWayPickupDateInput?.value) { showError(elements, 'pickup-date-oneway', 'Please select a date.'); isValid = false; }
            if (!elements.oneWayPickupTimeInput?.value) { showError(elements, 'pickup-time-oneway', 'Please select a time.'); isValid = false; }
          } else if (activePanelId === '#panel-experience-plus') {
            if (!selectedService) { showError(elements, 'experience-dropdown', 'Please select a Service.'); isValid = false; }
            else if (selectedService === 'hourly_chauffeur') {
              serviceType = 'Hourly';
              if (!elements.durationSelect?.value) { showError(elements, 'duration-hourly', 'Please select duration.'); isValid = false; }
              if (!elements.hourlyPickupDateInput?.value) { showError(elements, 'pickup-date-hourly', 'Please select a date.'); isValid = false; }
              if (!elements.hourlyPickupTimeInput?.value) { showError(elements, 'pickup-time-hourly', 'Please select a start time.'); isValid = false; }
            } else {
              serviceType = 'Experience';
              if (!elements.experienceNameInput?.value.trim()) { showError(elements, 'experience-name', 'Name required.'); isValid = false; }
              if (!elements.experienceGuestsInput?.value || parseInt(elements.experienceGuestsInput.value, 10) < 1) { showError(elements, 'experience-guests', 'Min 1 guest.'); isValid = false; }
              if (!elements.experienceEmailInput?.value.trim()) { showError(elements, 'experience-email', 'Email required.'); isValid = false; }
              else if (!/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(elements.experienceEmailInput.value.trim())) { showError(elements, 'experience-email', 'Invalid email.'); isValid = false; }
              if (!elements.experiencePhoneInput?.value.trim()) { showError(elements, 'experience-phone', 'Phone required.'); isValid = false; }
              else if (!/^\+?\d{10,15}$/.test(elements.experiencePhoneInput.value.replace(/\s+/g, ''))) { showError(elements, 'experience-phone', 'Invalid phone.'); isValid = false; }
              const datePrefSelected = document.querySelector('input[name="date_preference"]:checked');
              if (!datePrefSelected) { showError(elements, 'date_preference', 'Please select timing.'); isValid = false; }
              if (selectedService === 'wynwood_night') {
                const motivationSelected = document.querySelector('#wynwood-night-options input[name="motivation"]:checked');
                const dinnerPrefSelected = document.querySelector('#wynwood-night-options input[name="dinner_style_preference"]:checked');
                const loungeSelected = document.querySelector('#wynwood-night-options input[name="lounge_interest"]:checked');
                if (!motivationSelected) { showError(elements, 'motivation', 'Occasion required.'); isValid = false; }
                if (!dinnerPrefSelected) { showError(elements, 'dinner_style_preference', 'Dinner pref required.'); isValid = false; }
                if (!loungeSelected) { showError(elements, 'lounge_interest', 'Lounge interest required.'); isValid = false; }
              }
            }
          } else { isValid = false; console.error("No active tab panel."); }

          // Rule 3: Notes Validation
          if (elements.notesInput && elements.notesInput.value.length > config.MAX_NOTES_LENGTH) {
            showError(elements, 'notes', `Notes cannot exceed ${config.MAX_NOTES_LENGTH} characters.`);
            isValid = false;
          }
          return isValid;
        }

        // --- Form Data Processing ---
        function processFormData(elements) {
          const formData = new FormData(elements.bookingForm);
          let serviceType = '';
          let activePanelId = '';
          elements.formTabPanels.forEach(panel => { if (!panel.classList.contains('hidden')) activePanelId = `#${panel.id}`; });
          const selectedServiceValue = elements.serviceDropdown.value;

          if (activePanelId === '#panel-oneway') serviceType = 'One Way';
          else if (activePanelId === '#panel-experience-plus') serviceType = (selectedServiceValue === 'hourly_chauffeur') ? 'Hourly' : 'Experience';

          const dataObject = {
            service_type: serviceType,
            'from-location': formData.get('from-location'),
            notes: formData.get('notes') || ''
          };

          if (serviceType === 'One Way') {
            dataObject['to-address'] = formData.get('to-address');
            dataObject['pickup-date'] = formData.get('pickup-date-oneway');
            dataObject['pickup-time'] = formData.get('pickup-time-oneway');
          } else if (serviceType === 'Hourly') {
            dataObject['duration-hourly'] = formData.get('duration-hourly');
            dataObject['pickup-date'] = formData.get('pickup-date-hourly');
            dataObject['pickup-time'] = formData.get('pickup-time-hourly');
            dataObject.experience_name = "Hourly Chauffeur";
          } else if (serviceType === 'Experience') {
            dataObject.experience_name = elements.serviceDropdown.options[elements.serviceDropdown.selectedIndex].text;
            dataObject.date_preference = formData.get('date_preference');
            dataObject.name = formData.get('name');
            dataObject.guests = formData.get('guests');
            dataObject.email = formData.get('email');
            dataObject.phone = formData.get('phone');
            if (selectedServiceValue === 'wynwood_night') {
              dataObject.motivation = formData.get('motivation');
              dataObject.dinner_style_preference = formData.get('dinner_style_preference');
              if (formData.get('dinner_style_preference') === 'Other') {
                dataObject.other_restaurant_request = formData.get('other_restaurant_request');
              }
              dataObject.lounge_interest = formData.get('lounge_interest');
            }
          }
          console.log("Final Data Object:", dataObject);
          return dataObject;
        }

        // --- Form Submission ---
        function sendFormData(dataObject, elements, config) {
          setLoadingButton(elements);
          if (config.FORM_ENDPOINT === "YOUR_FORMSPREE_ENDPOINT") {
            setTimeout(() => { console.warn("Data logged to console. Set Formspree endpoint."); alert("DEV MODE: Data logged to console. Submission not sent."); resetSubmitButton(elements); }, 1500);
            return;
          }
          fetch(config.FORM_ENDPOINT, {
            method: 'POST',
            body: JSON.stringify(dataObject),
            headers: { 'Content-Type': 'application/json', 'Accept': 'application/json' }
          }).then(response => {
            if (response.ok) {
              const formContentContainer = elements.bookingForm.closest('.p-6');
              const tabNav = elements.tabNavigationContainer;
              if (formContentContainer) formContentContainer.classList.add('hidden');
              if (tabNav) tabNav.classList.add('hidden');
              if (elements.confirmationMessage) elements.confirmationMessage.classList.remove('hidden');
            } else {
              response.json().then(data => { showError(elements, 'submit-button', `Error: ${data.error || 'Could not submit request.'}`); resetSubmitButton(elements); })
                           .catch(() => { showError(elements, 'submit-button', 'Error: Could not submit request. Please try again.'); resetSubmitButton(elements); });
            }
          }).catch(error => { showError(elements, 'submit-button', 'Network error. Check connection.'); resetSubmitButton(elements); });
        }

        // --- Event Listener Setup ---
        function initializeEventListeners(elements, placeholders, config) {
          elements.tabNavigationContainer?.addEventListener('click', (event) => {
            const button = event.target.closest('.tab-button');
            if (button && button.dataset.tabTarget && !button.classList.contains('active-tab')) {
              switchTab(button.dataset.tabTarget, elements, placeholders);
            }
          });
          elements.serviceDropdown?.addEventListener('change', () => updateExperiencePlusPanelUI(elements, placeholders));
          elements.bookingForm?.querySelectorAll('input, select, textarea').forEach(input => {
            let targetId = input.id || input.name;
            input.addEventListener('input', () => clearError(targetId));
            input.addEventListener('change', () => clearError(targetId));
          });
          ['dinner_style_preference', 'motivation', 'lounge_interest', 'date_preference'].forEach(name => {
            document.querySelectorAll(`input[name="${name}"]`).forEach(radio => { radio.addEventListener('change', () => clearError(name)); });
          });
          elements.wynwoodDinnerPrefRadios?.forEach(radio => {
            radio.addEventListener('change', () => handleWynwoodDinnerChoice(elements));
          });
          elements.bookingForm?.addEventListener('submit', (event) => {
            event.preventDefault();
            clearAllErrors(elements);
            if (validateForm(elements)) {
              const data = processFormData(elements);
              sendFormData(data, elements, config);
            } else {
              const firstError = elements.bookingForm.querySelector('.ring-red-500');
              if (firstError) {
                const inputToFocus = document.getElementById(firstError.id.replace('-error','')) || firstError;
                inputToFocus.focus();
                inputToFocus.scrollIntoView({ behavior: 'smooth', block: 'center' });
              }
            }
          });
          console.log("Event listeners initialized.");
        }

        // --- Main Execution ---
        const elementRefs = getElementRefs();
        const appConfig = config;

        if (elementRefs.bookingForm) {
          initializeFlatpickr(elementRefs);
          initializeEventListeners(elementRefs, appConfig.placeholders, appConfig);
          switchTab('#panel-oneway', elementRefs, appConfig.placeholders);
        } else {
          console.error("Booking form not found. Script initialization incomplete.");
        }

      });
    </script>
  </body>
</html>