<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no" />
    <title>Booking - I ‚ù§Ô∏è Miami Concierge</title>    <link rel="stylesheet" href="css/main.css">
    <link rel="stylesheet" href="css/fix-place-autocomplete.css">
    <link rel="stylesheet" href="css/experience-modal.css">
    <link rel="stylesheet" href="css/components/experience-search-bar.css">
    <!-- Development/Production Environment Styles -->
    <style>
      /* Hide dev-only elements by default (for production) */
      .dev-only {
        display: none !important;
      }
    </style>
    <!-- Script to detect development environment and show dev tools if needed -->
    <script>
      // Check if we're in a development environment
      const isDevelopment = window.location.hostname === 'localhost' || 
                           window.location.hostname === '127.0.0.1' ||
                           window.location.hostname.includes('192.168.') ||
                           window.location.hostname.includes('.local') ||
                           window.location.search.includes('debug=true');
      
      // If in development, add a class to the HTML element and enable dev-only elements
      if (isDevelopment) {
        document.documentElement.classList.add('development');
        // Add a style tag to show dev-only elements in development
        const style = document.createElement('style');
        style.textContent = '.dev-only { display: initial !important; }';
        document.head.appendChild(style);
        console.log('üîß Development environment detected - Debug tools enabled');
      } else {
        document.documentElement.classList.add('production');
        console.log('üöÄ Production environment detected - Debug tools disabled');
      }
    </script>
    <!-- Replace this CDN link -->
     <!-- TODO: Consolidate Tailwind CSS - currently using both CDN and local file 
     Need to rebuild local file with all required components before removing CDN -->
<script src="https://cdn.tailwindcss.com"></script>
<link rel="stylesheet" href="css/tailwind.min.css">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/flatpickr/dist/flatpickr.min.css">
    <script src="https://cdn.jsdelivr.net/npm/flatpickr" defer></script>
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&family=Playfair+Display:wght@700&display=swap" rel="stylesheet" />
    <link href="https://fonts.googleapis.com/css2?family=Permanent+Marker&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="css/custom-places.css">
    <!-- Airbnb-style booking button styles -->
    <style>
    /* Airbnb-style booking button container */
      .airbnb-booking-container {
        display: flex;
        max-width: 400px;
        border: 1px solid #dddddd;
        border-radius: 32px;
        overflow: hidden;
        background: white;
        box-shadow: 0 1px 2px rgba(0, 0, 0, 0.08), 0 4px 12px rgba(0, 0, 0, 0.05);
        transition: box-shadow 0.2s ease;
        margin-bottom: 20px;
      }
        .booking-form-card {
        overflow: hidden;
      }

      .airbnb-booking-container:hover {
        box-shadow: 0 2px 4px rgba(0, 0, 0, 0.08), 0 8px 16px rgba(0, 0, 0, 0.1);
      }

      /* Individual booking buttons */
      .airbnb-booking-button {
        flex: 1;
        padding: 12px 16px !important;
        border: none;
        background: white;
        cursor: pointer;
        transition: all 0.2s ease;
        position: relative;
        min-height: 60px !important;
        display: flex;
        align-items: center;
        justify-content: center;
      }

      .airbnb-booking-button:hover {
        background: #f7f7f7;
      }

      .airbnb-booking-button.active {
        background: #f7f7f7;
        box-shadow: inset 0 0 0 2px #222222;
      }

      /* Left button active state with proper border radius */
      .airbnb-booking-button-left.active {
        border-radius: 32px 0 0 32px;
      }

      /* Right button active state with proper border radius */
      .airbnb-booking-button-right.active {
        border-radius: 0 32px 32px 0;
      }
      
      /* Experience Search Bar Styles are now in css/components/experience-search-bar.css */

.calendar-day-header {
    font-weight: 600;
    color: #717171;
    font-size: 12px;
    text-align: center;
    padding: 8px 0;
}

/* Guest Counter Styles */
.guest-controls {
    display: flex;
    justify-content: space-between;
    align-items: center;
    padding: 24px 0;
    border-bottom: 1px solid #ebebeb;
}

.guest-controls:last-child {
    border-bottom: none;
}

.guest-info {
    flex: 1;
}

.guest-type {
    font-size: 16px;
    font-weight: 600;
    color: #222222;
    margin-bottom: 4px;
}

.guest-description {
    font-size: 14px;
    color: #717171;
}

.guest-counter-controls {
    display: flex;
    align-items: center;
    gap: 16px;
}

.counter-button {
    width: 32px;
    height: 32px;
    border: 1px solid #b0b0b0;
    border-radius: 50%;
    background: white;
    cursor: pointer;
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 18px;
    font-weight: 600;
    color: #717171;
    transition: all 0.2s ease;
}

.counter-button:hover:not(:disabled) {
    border-color: #222222;
    color: #222222;
}

.counter-button:disabled {
    opacity: 0.3;
    cursor: not-allowed;
}

.counter-value {
    font-size: 16px;
    font-weight: 400;
    color: #222222;
    min-width: 20px;
    text-align: center;
}

/* Modal Footer */
.modal-footer {
    margin-top: 32px;
    display: flex;
    justify-content: flex-end;
    gap: 16px;
}

.confirm-btn {
    background: #222222;
    color: white;
    border: none;
    padding: 14px 24px;
    border-radius: 8px;
    font-size: 16px;
    font-weight: 600;
    cursor: pointer;
    transition: background-color 0.2s ease;
}

.confirm-btn:hover {
    background: #000000;
}

/* Experience Search Bar Clickability Fix */
.experience-search-bar .search-section {
    cursor: pointer !important;
    pointer-events: auto !important;
    position: relative !important;
    z-index: 1 !important;
    transition: all 0.2s ease;
    touch-action: manipulation;
    -webkit-tap-highlight-color: transparent;
    -webkit-user-select: none;
    -moz-user-select: none;
    -ms-user-select: none;
    user-select: none;
}

.experience-search-bar .search-section:hover {
    background-color: #ebebeb;
    transform: translateY(-1px);
    box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
}

.experience-search-bar .search-section:active {
    transform: translateY(0);
}

.experience-search-bar .search-value.has-value {
    color: #222222;
    font-weight: 500;
}

/* Mobile Responsive */
@media (max-width: 768px) {
    .modal-content {
        margin: 5% auto;
        width: 95%;
        padding: 24px;
    }
    
    .date-picker-container {
        flex-direction: column;
        gap: 24px;
    }
    
    .date-quick-options {
        flex: none;
        display: grid;
        grid-template-columns: repeat(2, 1fr);
        gap: 8px;
    }
    
    .quick-date-option {
        padding: 12px;
    }
}
    </style>
    <!-- Google Maps -->
<script src="https://maps.googleapis.com/maps/api/js?key=AIzaSyAd_O4s_73E_A8rq7TGCHKVEBFHzNecAHM&libraries=places&v=beta&loading=async"></script>

<!-- FIRST LOAD - at the top of the file -->
<script type="module">
  import eventBus from './src/core/EventBus.js';
  window.eventBus = eventBus;
  window.EventBus = eventBus.constructor;
  console.log('‚úÖ EventBus loaded and made global');
</script>
  
<!-- Core modules first -->
<script type="module" src="./core/EventDefinitions.js"></script>
<script type="module" src="./core/DOMManager.js"></script>
<script type="module" src="./core/ComponentRegistry.js"></script>

<!-- Essential functions before component loading -->
<script src="essential-functions.js"></script>

<!-- Component registration before dashboard.js -->
<script type="module" src="./dashboard-components.js"></script>

<!-- Application logic after components are registered -->
<script type="module" src="./dashboard.js"></script>
<script type="module" src="./simple-bridge.js"></script>
<script src="./js/booking-timing-bar.js"></script>

<!-- IMPORTANT: Delete this duplicate script loading section at the bottom of your HTML file -->
<!-- DELETE THIS SECTION
<script type="module" src="./core/EventDefinitions.js"></script>
<script type="module" src="./core/EventBus.js"></script>
<script type="module" src="./core/DOMManager.js"></script>
<script type="module" src="./core/ComponentRegistry.js"></script>
<script type="module" src="./dashboard-components.js"></script>
<script type="module" src="./dashboard.js"></script>
-->

<!-- Booking Timing Bar Component Script -->
<script src="./js/booking-timing-bar.js"></script>
  
  </head>
  <body class="bg-gray-100" style="background-image: url('images/miami-skyline-abstract-form.png'); background-size: cover; background-position: center; background-repeat: no-repeat;">
    <header class="site-header">
  <div class="header-container">    <!-- Logo -->
    <a href="index.html" class="site-logo">
      I ‚ù§Ô∏è <span class="brand-gradient-text">Miami</span>
    </a>

    <!-- Mobile menu toggle -->
    <button class="mobile-menu-toggle" aria-label="Toggle navigation menu" aria-expanded="false">
      <span></span>
      <span></span>
      <span></span>
    </button>

    <!-- Navigation menu -->
    <nav class="site-nav">
      <ul class="nav-list">
        <!-- Our experiences dropdown -->
        <li class="nav-item dropdown">
          <button class="nav-link dropdown-toggle" aria-expanded="false">
            Our experiences
            <svg class="dropdown-arrow" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="12" height="12">
              <path fill="currentColor" d="M7 10l5 5 5-5z"/>
            </svg>
          </button>
          <ul class="dropdown-menu">
            <li><a href="yacht.html" class="dropdown-item">Yacht & boat</a></li>
            <li><a href="wynwood.html" class="dropdown-item">Tours & Excursions(comming soon)</a></li>
            <li><a href="airport.html" class="dropdown-item">Events(comming soon)</a></li>

          </ul>
        </li>

        <!-- Partner with us dropdown -->
        <li class="nav-item dropdown">
          <button class="nav-link dropdown-toggle" aria-expanded="false">
            Partner With Us
            <svg class="dropdown-arrow" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="12" height="12">
              <path fill="currentColor" d="M7 10l5 5 5-5z"/>
            </svg>
          </button>
          <ul class="dropdown-menu">
            <li><a href="drivers.html" class="dropdown-item">Drivers(comming soon)</a></li>
            <li><a href="business.html" class="dropdown-item">Yatch Brokers(comming soon)</a></li>
            <li><a href="hotels.html" class="dropdown-item">Hotels & Resorts(coming soon)</a></li>
            <li><a href="events.html" class="dropdown-item">Event Planners(coming soon)</a></li>
          </ul>
        </li>  
            
          <!-- Direct links -->
        <li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" aria-expanded="false">
    Referral <span style="color: #00cc44;">$</span>
    <svg class="dropdown-arrow" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="12" height="12">
      <path fill="currentColor" d="M7 10l5 5 5-5z"/>
    </svg>
  </button>
  <ul class="dropdown-menu dropdown-menu-small">
    <li><a href="refer-driver.html" class="dropdown-item">Refer Driver(comming soon)</a></li>
    <li><a href="refer-friend.html" class="dropdown-item">Refer Friend(comming Soon)</a></li>
  </ul>
</li>

        <li class="nav-item dropdown">
          <button class="nav-link dropdown-toggle" aria-expanded="false">
            <svg class="inline-block" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="16" height="16" fill="currentColor" style="margin-right: 3px; vertical-align: -2px;">
      <path d="M12 17.27L18.18 21l-1.64-7.03L22 9.24l-7.19-.61L12 2 9.19 8.63 2 9.24l5.46 4.73L5.82 21 12 17.27Z"></path>
    </svg>
    Favorites
    <svg class="dropdown-arrow" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="12" height="12">
      <path fill="currentColor" d="M7 10l5 5 5-5z"/>
    </svg>
  </button>
  <ul class="dropdown-menu dropdown-menu-small">
    <li><a href="favorite-drivers.html" class="dropdown-item">Drivers(comming soon)</a></li>
    <li><a href="favorite-places.html" class="dropdown-item">Places(comming soon)</a></li>
  </ul>
</li>

        <!-- Language selector with SVG flags -->
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" aria-expanded="false">
    <span class="inline-flex items-center">
      <!-- USA Flag SVG -->
      <svg class="w-4 h-3 mr-2 inline-block" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 7410 3900" style="width: 18px; height: 12px; margin-right: 5px; vertical-align: -1px;">
        <rect width="7410" height="3900" fill="#b22234"/>
        <path d="M0,450H7410m0,600H0m0,600H7410m0,600H0m0,600H7410m0,600H0" stroke="#fff" stroke-width="300"/>
        <rect width="2964" height="2100" fill="#3c3b6e"/>
      </svg>
      English
    </span>
    <svg class="dropdown-arrow" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="12" height="12">
      <path fill="currentColor" d="M7 10l5 5 5-5z"/>
    </svg>
  </button>
  <ul class="dropdown-menu dropdown-menu-small">
    <li>
      <a href="?lang=en" class="dropdown-item">
        <!-- USA Flag SVG -->
        <svg class="w-4 h-3 mr-2 inline-block" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 7410 3900" style="width: 18px; height: 12px; margin-right: 5px; vertical-align: -1px;">
          <rect width="7410" height="3900" fill="#b22234"/>
          <path d="M0,450H7410m0,600H0m0,600H7410m0,600H0m0,600H7410m0,600H0" stroke="#fff" stroke-width="300"/>
          <rect width="2964" height="2100" fill="#3c3b6e"/>
        </svg>
        English
      </a>
    </li>
    <li>
      <a href="?lang=es" class="dropdown-item">
        <!-- Spain Flag SVG -->
        <svg class="w-4 h-3 mr-2 inline-block" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 750 500" style="width: 18px; height: 12px; margin-right: 5px; vertical-align: -1px;">
          <rect width="750" height="500" fill="#c60b1e"/>
          <rect width="750" height="250" y="125" fill="#ffc400"/>
        </svg>
        Espa√±ol
      </a>
    </li>
    <li>
      <a href="?lang=pt" class="dropdown-item">
        <!-- Brazil/Portuguese Flag SVG -->
        <svg class="w-4 h-3 mr-2 inline-block" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 720 504" style="width: 18px; height: 12px; margin-right: 5px; vertical-align: -1px;">
          <rect width="720" height="504" fill="#009b3a"/>
          <path d="M360,72 L620,252 L360,432 L100,252 Z" fill="#ffdf00"/>
          <circle cx="360" cy="252" r="80" fill="#002776" stroke="#fff" stroke-width="10"/>
        </svg>
        Portugu√™s
      </a>
    </li>
    <li>
      <a href="?lang=fr" class="dropdown-item">
        <!-- French Flag SVG -->
        <svg class="w-4 h-3 mr-2 inline-block" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 900 600" style="width: 18px; height: 12px; margin-right: 5px; vertical-align: -1px;">
          <rect width="300" height="600" fill="#002395"/>
          <rect width="300" height="600" x="300" fill="#fff"/>
          <rect width="300" height="600" x="600" fill="#ed2939"/>
        </svg>
        Fran√ßais
      </a>
    </li>
  </ul>
</li>

        <!-- Sign in -->
        <li class="nav-item">
          <a href="login.html" class="nav-link">Sign in</a>
        </li>
      </ul>
    </nav>
  </div>
</header>

    <main>
      <!-- Left column - Hero content -->
      <div class="hero-content">
        <h1 class="text-4xl md:text-5xl font-bold mb-6" style="font-family: 'Playfair Display', serif; color: #333333; text-shadow: -1px -1px 0 #fff, 1px -1px 0 #fff, -1px 1px 0 #fff, 1px 1px 0 #fff;">Time is Valuable Enjoy the moment</h1>
        <p class="text-xl mb-8" style="font-family: 'Playfair Display', serif; font-weight: bold; color: #97a9bb;">
  <span style="color: #ff0000; font-size: 1.5rem;">‚ù§Ô∏è</span> 
  The Uber of Experiences. Don't Just see it, live it.
</p>
      </div>
      
      <!-- Right column - Booking form -->
      <div class="booking-form-container">
        <div class="booking-form-card">
          <div id="tab-navigation" class="border-b border-gray-200">
  <nav class="-mb-px flex w-full" aria-label="Tabs" role="tablist">
    <button type="button" id="tab-button-oneway" data-tab-target="#panel-oneway" 
            class="tab-button" 
            role="tab" aria-selected="true" aria-controls="panel-oneway">One Way</button>
    <button type="button" id="tab-button-experience-plus" data-tab-target="#panel-experience-plus" 
            class="tab-button" 
            role="tab" aria-selected="false" aria-controls="panel-experience-plus">Experience +</button>
  </nav>
</div>

          <div class="form-padding">
            
            <form action="#" method="POST" id="booking-form" class="space-y-4">
              <div class="tab-panels space-y-3 pt-2">
                <div id="panel-oneway" class="tab-panel space-y-3" role="tabpanel" tabindex="0" aria-labelledby="tab-button-oneway">
                  <!-- ONE WAY TAB: Show both From and To locations -->
                  <div id="location-fields-container-oneway" class="space-y-4">
                    <!-- From Input -->
                    <div class="relative">
                      <div class="google-maps-container">
                        <label for="from-location" class="location-label">Starting Location</label>
                        <span class="location-icon">
                          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor">
                            <path d="M12 2C8.13 2 5 5.13 5 9c0 5.25 7 13 7 13s7-7.75 7-13c0-3.87-3.13-7-7-7zm0 9.5c-1.38 0-2.5-1.12-2.5-2.5s1.12-2.5 2.5-2.5 2.5 1.12 2.5 2.5-1.12 2.5-2.5 2.5z"/>
                          </svg>
                        </span>
                        <gmp-place-autocomplete id="from-location" placeholder="Enter pickup location..."></gmp-place-autocomplete>
                      </div>
                      <span id="from-location-error" class="mt-1 block text-xs text-red-600 hidden"></span>
                    </div>

                    <!-- To Input -->
                    <div class="google-maps-container">
                      <label for="to-address" class="location-label">To</label>
                      <span class="location-icon">
                        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor">
                          <path d="M12 11.5A2.5 2.5 0 0 1 9.5 9A2.5 2.5 0 0 1 12 6.5A2.5 2.5 0 0 1 14.5 9a2.5 2.5 0 0 1-2.5 2.5M12 2a7 7 0 0 0-7 7c0 5.25 7 13 7 13s7-7.75 7-13a7 7 0 0 0-7-7z"></path>
                        </svg>
                      </span>
                      <gmp-place-autocomplete id="to-address"
                        address-filter="country:us"
                        type-filter="establishment,geocode,airport,lodging,point_of_interest,tourist_attraction" 
                        placeholder="Enter drop-off location"
                        required
                        aria-describedby="to-address-error">
                      </gmp-place-autocomplete>
                      <span id="to-address-error" class="mt-1 block text-xs text-red-600 hidden"></span>
                    </div>
                  </div>                  <div id="date-time-container-oneway" class="relative">
                    <input type="hidden" name="booking_preference" id="booking-preference" value="">
                      <div class="booking-timing-container">
                        <div class="experience-search-bar booking-timing-bar" id="bookingTimingContainer">
                          <div class="search-section" id="requestNowSection">
                              <div class="search-label">When</div>
                              <div class="search-value" id="requestNowValue">Request Now</div>
                          </div>
                          <div class="search-section" id="bookLaterSection">
                              <div class="search-label">Schedule</div>
                              <div class="search-value" id="bookLaterValue">Book for Later</div>
                          </div>
                          <button class="search-button" id="confirmTimingButton">
                              <svg fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2.5" d="M5 13l4 4L19 7"></path>
                              </svg>
                          </button>
                        </div>
                      </div>
                  </div>
                  <span id="booking-time-error" class="mt-1 block text-xs text-red-600 hidden"></span>

                  <div id="scheduled-booking-inputs" class="hidden mt-4 space-y-4">
                    <div class="grid grid-cols-1 sm:grid-cols-2 gap-x-4 gap-y-4">
                      <div>
                         <label for="pickup-date-oneway" class="block text-xs font-medium text-gray-500 mb-0.5">Date</label>
                         <input type="text" name="pickup-date-oneway" id="pickup-date-oneway" aria-describedby="pickup-date-oneway-error" class="block w-full rounded-md border-0 py-3 px-3 text-gray-900 ring-1 ring-inset ring-gray-300 focus:ring-2 focus:ring-[--color-gold] sm:text-sm" placeholder="Select Date..." />
                         <span id="pickup-date-oneway-error" class="mt-1 block text-xs text-red-600 hidden"></span>
                      </div>                      <div>
                         <label for="pickup-time-oneway" class="block text-xs font-medium text-gray-500 mb-0.5">Time</label>
                         <select name="pickup-time-oneway" id="pickup-time-oneway" required aria-describedby="pickup-time-oneway-error" class="block w-full rounded-md border-0 py-3 px-3 text-gray-900 ring-1 ring-inset ring-gray-300 focus:ring-2 focus:ring-[--color-gold] sm:text-sm">
                            <option value="">Select Time...</option>
                            <option value="06:00 AM">6:00 AM</option>
                            <option value="06:30 AM">6:30 AM</option>
                            <option value="07:00 AM">7:00 AM</option>
                            <option value="07:30 AM">7:30 AM</option>
                            <option value="08:00 AM">8:00 AM</option>
                            <option value="08:30 AM">8:30 AM</option>
                            <option value="09:00 AM">9:00 AM</option>
                            <option value="09:30 AM">9:30 AM</option>
                            <option value="10:00 AM">10:00 AM</option>
                            <option value="10:30 AM">10:30 AM</option>
                            <option value="11:00 AM">11:00 AM</option>
                            <option value="11:30 AM">11:30 AM</option>
                            <option value="12:00 PM">12:00 PM</option>
                            <option value="12:30 PM">12:30 PM</option>
                            <option value="01:00 PM">1:00 PM</option>
                            <option value="01:30 PM">1:30 PM</option>
                            <option value="02:00 PM">2:00 PM</option>
                            <option value="02:30 PM">2:30 PM</option>
                            <option value="03:00 PM">3:00 PM</option>
                            <option value="03:30 PM">3:30 PM</option>
                            <option value="04:00 PM">4:00 PM</option>
                            <option value="04:30 PM">4:30 PM</option>
                            <option value="05:00 PM">5:00 PM</option>
                            <option value="05:30 PM">5:30 PM</option>
                            <option value="06:00 PM">6:00 PM</option>
                            <option value="06:30 PM">6:30 PM</option>
                            <option value="07:00 PM">7:00 PM</option>
                            <option value="07:30 PM">7:30 PM</option>
                            <option value="08:00 PM">8:00 PM</option>
                            <option value="08:30 PM">8:30 PM</option>
                            <option value="09:00 PM">9:00 PM</option>
                            <option value="09:30 PM">9:30 PM</option>
                            <option value="10:00 PM">10:00 PM</option>
                            <option value="10:30 PM">10:30 PM</option>
                            <option value="11:00 PM">11:00 PM</option>
                            <option value="11:30 PM">11:30 PM</option>
                        </select>
                         <span id="pickup-time-oneway-error" class="mt-1 block text-xs text-red-600 hidden"></span>
                      </div>
                   </div>
                  </div>

                  <div id="vehicle-selection-oneway" class="vehicle-selection-container pt-4">
                    <h3 class="text-lg font-medium text-gray-900 mb-3">Select Your Vehicle</h3>
                    <fieldset aria-labelledby="vehicle-selection-oneway-label" aria-describedby="vehicle-type-oneway-error">
                       <legend class="sr-only">Vehicle Selection</legend>
                       <div class="space-y-3 divide-y divide-gray-200">

                         <label for="vehicle-sedan-card" class="vehicle-card pt-3 flex items-center justify-between rounded-lg border border-transparent bg-white px-2 sm:px-3 py-3 sm:py-4 shadow-sm cursor-pointer transition duration-150 ease-in-out focus-within:ring-2 focus-within:ring-[--color-teal]">
                           <div class="vehicle-card-content flex items-center space-x-4 w-full">
                             <div class="vehicle-image-container flex-shrink-0 w-28 aspect-[4/3] overflow-hidden rounded-md">
                               <img src="images/luxury-sedan.jpg" alt="Luxury Sedan" class="w-full h-full object-cover">
                             </div>
                             <div class="vehicle-card-details">
                               <p class="text-base font-medium text-gray-900">Luxury Sedan</p>
                               <div class="flex items-center space-x-3 text-xs text-gray-500 mt-1">
                                 <span class="flex items-center">
                                   <svg class="w-3.5 h-3.5 mr-1 text-[--color-teal]" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor"><path d="M10 8a3 3 0 100-6 3 3 0 000 6zM3.465 14.493a1.23 1.412 0 00.41 1.412A9.957 9.957 0 0010 18c2.31 0 4.438-.784 6.131-2.1.43-.333.604-.903.41-1.412A9.978 9.978 0 0010 12c-2.31 0-4.438.784-6.131 2.1-.194.51-.02.979.406 1.393z" /></svg>
                                   <span class="font-medium">3</span>
                                 </span>
                                 <span class="flex items-center">
                                   <svg class="w-3.5 h-3.5 mr-1 text-[--color-teal]" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor"><path fill-rule="evenodd" d="M6 3.75A2.75 2.75 0 018.75 1h2.5A2.75 2.75 0 0114 3.75v.443c.57.055 1.14.122 1.71.2V3.75a.75.75 0 00-1.5 0v-.194c-1.06-.214-2.14-.214-3.2 0V6.5a.75.75 0 00-1.5 0v-.409c-.55.125-1.14.228-1.75.315zM5.5 6.6v8.15h9V6.6a18.225 18.225 0 01-4.5 0c-1.06.214-2.14.214-3.2 0a18.225 18.225 0 01-1.3 0z" clip-rule="evenodd" /> </svg>
                                   <span class="font-medium">2</span>
                                 </span>
                               </div>
                               <p class="text-xs text-gray-500 mt-1">e.g., Tesla Model Y</p>
                               <div class="badge-container flex flex-wrap gap-2 mt-1.5">
                                  <span class="inline-flex items-center px-2 py-0.5 rounded text-xs font-medium bg-[--color-green-100] text-[--color-green-800]">EV Available</span>
                               </div>
                             </div>
                           </div>

                            <input type="radio" name="vehicle_type_oneway" value="Luxury Sedan" id="vehicle-sedan-card" class="sr-only" required aria-checked="false">
                         </label>

                         <label for="vehicle-suv-card" class="vehicle-card pt-3 flex items-center justify-between rounded-lg border border-transparent bg-white px-2 sm:px-3 py-3 sm:py-4 shadow-sm cursor-pointer transition duration-150 ease-in-out focus-within:ring-2 focus-within:ring-[--color-teal]">
                            <div class="vehicle-card-content flex items-center space-x-4 w-full">
                              <div class="vehicle-image-container flex-shrink-0 w-28 aspect-[4/3] overflow-hidden rounded-md">
                                <img src="images/premium-suv-escalade.jpg" alt="Premium SUV" class="w-full h-full object-cover">
                             </div>
                             <div class="vehicle-card-details">
                               <p class="text-base font-medium text-gray-900">Premium SUV</p>
                               <div class="flex items-center space-x-3 text-xs text-gray-500 mt-1">
                                 <span class="flex items-center">
                                   <svg class="w-3.5 h-3.5 mr-1 text-[--color-teal]" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor"> <path d="M10 8a3 3 0 100-6 3 3 0 000 6zM3.465 14.493a1.23 1.412 0 00.41 1.412A9.957 9.957 0 0010 18c2.31 0 4.438-.784 6.131-2.1.43-.333.604-.903.41-1.412A9.978 9.978 0 0010 12c-2.31 0-4.438.784-6.131 2.1-.194.51-.02.979.406 1.393z" /> </svg>
                                   <span class="font-medium">6</span>
                                 </span>
                                 <span class="flex items-center">
                                   <svg class="w-3.5 h-3.5 mr-1 text-[--color-teal]" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor"> <path fill-rule="evenodd" d="M6 3.75A2.75 2.75 0 018.75 1h2.5A2.75 2.75 0 0114 3.75v.443c.57.055 1.14.122 1.71.2V3.75zM4.75 5.11v9.14a.75.75 0 00.75.75h9a.75.75 0 00.75-.75v-9.14c-.61-.087-1.2-.19-1.75-.315V6.5a.75.75 0 00-1.5 0v-.194c-1.06-.214-2.14-.214-3.2 0V6.5a.75.75 0 00-1.5 0v-.409c-.55.125-1.14.228-1.75.315zM5.5 6.6v8.15h9V6.6a18.225 18.225 0 01-4.5 0c-1.06.214-2.14.214-3.2 0a18.225 18.225 0 01-1.3 0z" clip-rule="evenodd" /> </svg>
                                   <span class="font-medium">5</span>
                                 </span>
                               </div>
                               <p class="text-xs text-gray-500 mt-1">e.g., Cadillac Escalade</p>
                                <div class="badge-container flex flex-wrap gap-2 mt-1.5">
                                  <span class="inline-flex items-center px-2 py-0.5 rounded text-xs font-medium bg-[--color-green-100] text-[--color-green-800]">EV Available</span>
                               </div>
                             </div>
                           </div>

                            <input type="radio" name="vehicle_type_oneway" value="Premium SUV" id="vehicle-suv-card" class="sr-only" required aria-checked="false">
                         </label>

                         <label for="vehicle-sprinter-card" class="vehicle-card pt-3 flex items-center justify-between rounded-lg border border-transparent bg-white px-2 sm:px-3 py-3 sm:py-4 shadow-sm cursor-pointer transition duration-150 ease-in-out focus-within:ring-2 focus-within:ring-[--color-teal]">
                            <div class="vehicle-card-content flex items-center space-x-4 w-full">
                              <div class="vehicle-image-container flex-shrink-0 w-28 aspect-[4/3] overflow-hidden rounded-md">
                                <img src="images/vip-sprinter.jpg" alt="VIP Sprinter" class="w-full h-full object-cover">
                             </div>
                             <div class="vehicle-card-details">
                               <p class="text-base font-medium text-gray-900">VIP Group Sprinter</p>
                               <div class="flex items-center space-x-3 text-xs text-gray-500 mt-1">
                                 <span class="flex items-center">
                                   <svg class="w-3.5 h-3.5 mr-1 text-[--color-teal]" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor"> <path d="M10 8a3 3 0 100-6 3 3 0 000 6zM3.465 14.493a1.23 1.412 0 00.41 1.412A9.957 9.957 0 0010 18c2.31 0 4.438-.784 6.131-2.1.43-.333.604-.903.41-1.412A9.978 9.978 0 0010 12c-2.31 0-4.438.784-6.131 2.1-.194.51-.02.979.406 1.393z" /> </svg>
                                   <span class="font-medium">14</span>
                                 </span>
                                 <span class="flex items-center">
                                   <svg class="w-3.5 h-3.5 mr-1 text-[--color-teal]" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor"> <path fill-rule="evenodd" d="M6 3.75A2.75 2.75 0 018.75 1h2.5A2.75 2.75 0 0114 3.75v.443c.57.055 1.14.122 1.71.2V3.75A3.75 3.75 0 0012 0h-4A3.75 3.75 0 004.25 3.75v.643c.57-.078 1.14-.145 1.71-.2V3.75zM4.75 5.11v9.14a.75.75 0 00.75.75h9a.75.75 0 00.75-.75v-9.14c-.61-.087-1.2-.19-1.75-.315V6.5a.75.75 0 00-1.5 0v-.194c-1.06-.214-2.14-.214-3.2 0V6.5a.75.75 0 00-1.5 0v-.409c-.55.125-1.14.228-1.75.315zM5.5 6.6v8.15h9V6.6a18.225 18.225 0 01-4.5 0c-1.06.214-2.14.214-3.2 0a18.225 18.225 0 01-1.3 0z" clip-rule="evenodd" /> </svg>
                                   <span class="font-medium">14</span>
                                 </span>
                               </div>
                               <p class="text-xs text-gray-500 mt-1">e.g., Mercedes Sprinter</p>
                                <div class="badge-container flex flex-wrap gap-2 mt-1.5">
                                  <span class="inline-flex items-center px-2 py-0.5 rounded text-xs font-medium bg-[--color-blue-100] text-[--color-blue-800]">Mobile Lounge</span>
                               </div>
                             </div>
                           </div>

                            <input type="radio" name="vehicle_type_oneway" value="VIP Group Sprinter" id="vehicle-sprinter-card" class="sr-only" required aria-checked="false">
                         </label>

                       </div> <span id="vehicle-type-oneway-error" class="mt-1 block text-xs text-red-600 hidden"></span> </fieldset>
                  </div>
                  </div>
                <div id="panel-experience-plus" class="tab-panel space-y-3 hidden" role="tabpanel" tabindex="0" aria-labelledby="tab-button-experience-plus">
                  <!-- EXPERIENCE+ TAB: Show only Starting Location -->
                  <div id="location-fields-container-experience" class="space-y-4">
                    <!-- Starting Location Only -->
                    <div class="relative">
                      <div class="google-maps-container">
                        <label for="from-location-exp" class="location-label">Starting Location</label>
                        <span class="location-icon">
                          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor">
                            <path d="M12 2C8.13 2 5 5.13 5 9c0 5.25 7 13 7 13s7-7.75 7-13c0-3.87-3.13-7-7-7zm0 9.5c-1.38 0-2.5-1.12-2.5-2.5s1.12-2.5 2.5-2.5 2.5 1.12 2.5 2.5-1.12 2.5-2.5 2.5z"/>
                          </svg>
                        </span>
                        <gmp-place-autocomplete id="from-location-exp" placeholder="Enter starting location..." style="max-width: 100%; width: 100%; height: auto;"></gmp-place-autocomplete>
                      </div>
                      <span id="from-location-exp-error" class="mt-1 block text-xs text-red-600 hidden"></span>
                    </div>
                      <!-- Enhanced Airbnb-style Search Bar -->
                    <div class="experience-search-container">
                      <div class="experience-search-bar" id="experienceSearchContainer">
                        <div class="search-section" id="experienceDateSection">
                            <div class="search-label">Date</div>
                            <div class="search-value" id="experienceDateValue">Add dates</div>
                        </div>
                        <div class="search-section" id="experienceGuestSection">
                            <div class="search-label">Who</div>
                            <div class="search-value" id="experienceGuestValue">Add guests</div>
                        </div>
                        <button class="search-button" id="experienceSearchButton">
                            <svg fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2.5" d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"/>
                            </svg>
                        </button>
                      </div>
                    </div>
                  </div>
                </div>
              </div>

              <div class="form-action-buttons">
                <button type="button" id="reset-button" class="flex items-center text-gray-500 hover:text-[--color-teal] transition-colors duration-200 px-3 py-1.5 rounded-md hover:bg-gray-100">
                  <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4 mr-1" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15" />
                  </svg>
                  Reset
                </button>
                <button type="submit" id="submit-button" disabled
                    class="flex items-center justify-center text-lg font-semibold"
                    title="Complete all required fields to enable submission" aria-disabled="true" aria-busy="false">
                    <span class="spinner hidden" aria-hidden="true"></span>
                    <span class="button-text">Continue</span>
                </button>
              </div>
            </form>

            <div id="confirmation-message" class="hidden text-center mt-6">
              <h3 class="font-playfair text-xl text-gray-900">Thank You!</h3>
              <p class="text-gray-600">Your request has been submitted successfully. We'll get back to you soon.</p>
            </div>
          </div>
        </div>
      </div>    </main>    
<!-- COMMENT OUT OR REMOVE this debug section before pushing to production -->
<!--
<div style="position: fixed; top: 10px; right: 10px; background: white; padding: 10px; border: 1px solid #ccc; z-index: 9999;">
  <h4>üîß Debug Controls</h4>
  <button onclick="forceLocationValidation('from-location', 'oneway', 'fromLocation')" 
          style="display: block; margin: 5px 0; padding: 5px 10px; background: #10b981; color: white; border: none; border-radius: 4px;">
    ‚úÖ Force From Valid
  </button>
  <button onclick="forceLocationValidation('to-address', 'oneway', 'toAddress')" 
          style="display: block; margin: 5px 0; padding: 5px 10px; background: #10b981; color: white; border: none; border-radius: 4px;">
    ‚úÖ Force To Valid
  </button>
  <button onclick="console.log('FormState:', window.formState)" 
          style="display: block; margin: 5px 0; padding: 5px 10px; background: #3b82f6; color: white; border: none; border-radius: 4px;">
    üîç Check State
  </button>
  <button onclick="document.getElementById('vehicle-selection-oneway').classList.add('show')" 
          style="display: block; margin: 5px 0; padding: 5px 10px; background: #059669; color: white; border: none; border-radius: 4px;">
    ‚ú® Add SHOW Class
  </button>
</div>
-->

<!-- Script for Booking Timing Bar Component -->
<script src="./js/booking-timing-bar.js"></script>

<!-- Script for Date/Time Input Visual Feedback Enhancements -->
<script>
  document.addEventListener('DOMContentLoaded', function() {
    // Add icons to the date and time inputs
    const dateInput = document.getElementById('pickup-date-oneway');
    const timeInput = document.getElementById('pickup-time-oneway');
    
    if (dateInput) {
      const dateIconContainer = document.createElement('span');
      dateIconContainer.className = 'input-icon';
    }
    
    if (timeInput) {
      const timeIconContainer = document.createElement('span');
      timeIconContainer.className = 'input-icon';
      timeIconContainer.innerHTML = '<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" viewBox="0 0 16 16"><path d="M8 3.5a.5.5 0 0 0-1 0V9a.5.5 0 0 0 .252.434l3.5 2a.5.5 0 0 0 .496-.868L8 8.71V3.5z"/><path d="M8 16A8 8 0 1 0 8 0a8 8 0 0 0 0 16zm7-8A7 7 0 1 1 1 8a7 7 0 0 1 14 0z"/></svg>';
      timeInput.parentNode.style.position = 'relative';
      timeInput.parentNode.appendChild(timeIconContainer);
    }
    
    // Note: Shimmer effect for scheduled booking container is now handled by booking-timing-bar.js
  });
</script>

<!-- Enhanced Date/Time Input Behavior -->
<script>
// Enhanced Date/Time Input Behavior
document.addEventListener('DOMContentLoaded', function() {
    const dateInput = document.getElementById('pickup-date-oneway');
    const timeInput = document.getElementById('pickup-time-oneway');
    
    // Add filled class when inputs have values
    function updateInputState(input) {
        if (input && input.value.trim() !== '') {
            input.classList.add('filled');
        } else if (input) {
            input.classList.remove('filled');
        }
    }
    
    // Monitor input changes
    if (dateInput) {
        dateInput.addEventListener('change', () => updateInputState(dateInput));
        dateInput.addEventListener('input', () => updateInputState(dateInput));
        // Check initial state
        updateInputState(dateInput);
    }
    
    if (timeInput) {
        timeInput.addEventListener('change', () => updateInputState(timeInput));
        timeInput.addEventListener('input', () => updateInputState(timeInput));
        // Check initial state
        updateInputState(timeInput);
    }
      // Enhanced Flatpickr configuration for date picker only
    if (dateInput && typeof flatpickr !== 'undefined') {
        flatpickr(dateInput, {
            dateFormat: "M j, Y",
            minDate: "today",
            theme: "airbnb",
            animate: true,
            onChange: function(selectedDates, dateStr, instance) {
                updateInputState(dateInput);
                console.log('Date selected:', dateStr);
            }
        });
    }
    
    // Time picker now using standard dropdown select - no Flatpickr needed
    if (timeInput) {
        timeInput.addEventListener('change', function() {
            updateInputState(timeInput);
            console.log('Time selected:', timeInput.value);
        });
    }
});
</script>
<!-- Experience Search Bar Component -->
<script>
// Initialize the global experienceSearchBar variable
window.experienceSearchBar = null;

document.addEventListener('DOMContentLoaded', function() {
    // Wait for DOM to be fully loaded
    setTimeout(() => {
        // Make sure we have the search container
        if (document.getElementById('experienceSearchContainer')) {
            console.log('Initializing enhanced experience search bar');
        }
    }, 100);
});
</script>

<!-- Update the Experience Search Bar JavaScript to properly connect click events -->
<script>
document.addEventListener('DOMContentLoaded', function() {
  // Wait for DOM to be fully loaded, then initialize with a small delay to ensure all elements are rendered
  setTimeout(() => {
    // Only create one instance of the ExperienceSearchBar class
    if (document.getElementById('experienceSearchContainer')) {
      // Remove any previous initialization
      if (window.experienceSearchBar) {
        console.log('Existing search bar found, updating');
        
        // Re-initialize the component to ensure all event listeners are attached
        window.experienceSearchBar.init();
      } else {
        console.log('Initializing experience search bar');
        // Create and store the instance globally
        window.experienceSearchBar = new ExperienceSearchBar();
        window.experienceSearchBar.init(); // Initialize the component
      }
    }
  }, 200); // Increased delay to ensure DOM is fully loaded
});
</script>

<!-- Enhanced Debug Controls (only visible in development) -->
<div id="debug-controls" class="dev-only" style="position: fixed; top: 10px; left: 10px; background: rgba(0,0,0,0.9); color: white; padding: 15px; border-radius: 8px; z-index: 9998; font-family: monospace; font-size: 12px; max-width: 300px; display: none;">
  <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 10px;">
    <h4 style="margin: 0; color: #00ff88;">üîß Miami Concierge Debug Panel</h4>
    <div>
      <button id="debug-panel-minimize" style="background: none; border: none; color: white; cursor: pointer; font-size: 16px; padding: 0; margin-right: 5px;" title="Minimize panel">_</button>
      <button id="debug-panel-close" style="background: none; border: none; color: #ff3333; cursor: pointer; font-size: 18px; padding: 0; font-weight: bold;" title="Close panel">√ó</button>
    </div>
  </div>
  
  <div id="debug-panel-content">
    <div style="margin-bottom: 10px;">
      <strong style="color: #00bcd4;">Form Validation:</strong>
      <button onclick="forceLocationValidation('from-location', 'oneway', 'fromLocation')" 
              style="display: block; margin: 3px 0; padding: 4px 8px; background: #10b981; color: white; border: none; border-radius: 3px; font-size: 11px;">
        ‚úÖ Force From Valid
      </button>
      <button onclick="forceLocationValidation('to-address', 'oneway', 'toAddress')" 
              style="display: block; margin: 3px 0; padding: 4px 8px; background: #10b981; color: white; border: none; border-radius: 3px; font-size: 11px;">
        ‚úÖ Force To Valid
      </button>
      <button onclick="console.log('FormState:', window.formState)" 
        <button class="guest-button" id="infantIncrease">
          <svg width="12" height="12" viewBox="0 0 12 12" fill="none">
            <rect y="5" width="12" height="2" rx="1" fill="currentColor"/>
            <rect x="5" width="2" height="12" rx="1" fill="currentColor"/>
          </svg>
        </button>
      </div>
    </div>
  </div>
  <div class="experience-modal-footer">
    <button class="modal-clear-btn" id="guestClearBtn">Clear</button>
    <button class="modal-save-btn" id="guestSaveBtn">Save</button>
  </div>
</div>

<!-- Experience Search Bar JavaScript -->
<script>  // ExperienceSearchBar class for experience search functionality
class ExperienceSearchBar {
    constructor() {
      // Search bar elements
      this.searchContainer = document.getElementById('experienceSearchContainer');
      // Location section removed - using Place Autocomplete directly
      this.dateSection = document.getElementById('experienceDateSection');
      this.guestSection = document.getElementById('experienceGuestSection');
      this.searchButton = document.getElementById('experienceSearchButton');
      
      // Values display elements
      // Location value removed - using Place Autocomplete directly
      this.dateValue = document.getElementById('experienceDateValue');
      this.guestValue = document.getElementById('experienceGuestValue');
      
      // Legacy modal elements (kept for backward compatibility)
      this.modalOverlay = document.getElementById('experienceModalOverlay');
      this.locationModal = document.getElementById('experienceLocationModal');
      this.dateModal = document.getElementById('experienceDateModal');
      this.guestModal = document.getElementById('experienceGuestModal');
      
      // New unified modal system elements
      this.modal = document.getElementById('modal');
      this.modalTitle = document.getElementById('modalTitle');
      this.modalBody = document.getElementById('modalBody');
      this.closeModalBtn = document.getElementById('closeModal');
      this.confirmBtn = document.getElementById('confirmSelection');
      this.currentModalType = null; // To track which modal is currently open: 'date' or 'guest'
      
      // State variables
      this.selectedLocation = '';
      this.selectedDate = '';
      this.guests = {
        adults: 0,
        children: 0,
        infants: 0
      };
      
      // Flatpickr instance      
      this.calendar = null;
    }    init() {
      // Check if all required elements exist
      if (!this.searchContainer || !this.dateSection || 
          !this.guestSection || !this.searchButton) {
        console.warn('Experience search bar elements not found.');
        return;
      }
      
      // Check if unified modal system exists
      if (!this.modal || !this.modalTitle || !this.modalBody || !this.closeModalBtn || !this.confirmBtn) {
        console.warn('Unified modal system elements not found. Will use legacy modals if available.');
      }
      
      // Initialize date format for quick options
      this.initDateOptions();
      
      // Initialize flatpickr calendar
      this.initCalendar();
      
      // Initialize Google Maps Place Autocomplete integration
      this.initPlaceAutocomplete();
      
      // Attach event listeners
      this.attachEventListeners();
      
      console.log('‚úÖ Experience Search Bar initialized');
    }
      initPlaceAutocomplete() {
      // Get the place autocomplete element
      const placeInput = document.getElementById('from-location-exp');
      if (!placeInput) {
        console.warn('Place autocomplete input not found');
        return;
      }
      
      // We don't need to initialize the autocomplete as it's already handled by Google Maps API
      // Just add a listener to store the selected place
      placeInput.addEventListener('gmp-placeselect', (event) => {
        const place = event.target.place;
        if (place) {
          const name = place.displayName || place.name || place.formatted_address;
          console.log('Selected place:', name);
          this.selectedLocation = {
            name: name,
            placeId: place.id,
            coordinates: place.geometry ? {
              lat: place.geometry.location.lat(),
              lng: place.geometry.location.lng()
            } : null
          };
        }
      });
      
      console.log('‚úÖ Place Autocomplete initialized');
    }
      attachEventListeners() {
      console.log('üîÑ Attaching experience search bar event listeners');
      
      // Add event listeners to search sections for opening modals
      if (this.dateSection) {
        this.dateSection.addEventListener('click', () => {
          console.log('üìÖ Date section clicked');
          this.showModal('date');
        });
      }
      
      if (this.guestSection) {
        this.guestSection.addEventListener('click', () => {
          console.log('üë• Guest section clicked');
          this.showModal('guest');
        });
      }
      
      // Close modal when clicking on close button
      if (this.closeModalBtn) {
        this.closeModalBtn.addEventListener('click', () => {
          this.hideAllModals();
        });
      }
      
      // Close modal when clicking outside the modal content
      window.addEventListener('click', (event) => {
        if (event.target === this.modal) {
          this.hideAllModals();
        }
      });
      
      // Modal close buttons
      const closeButtons = document.querySelectorAll('.experience-modal-close');
      closeButtons.forEach(button => {
        button.addEventListener('click', () => {
          this.hideAllModals();
        });
      });
      
      // Date modal events
      if (this.dateModal) {
        // Date options click events
        const dateOptions = this.dateModal.querySelectorAll('.date-option');
        dateOptions.forEach(option => {
          option.addEventListener('click', (e) => {
            const dateType = e.currentTarget.dataset.date;
            this.selectDateOption(dateType);
          });
        });
        
        // Save button
        const dateSaveBtn = document.getElementById('dateSaveBtn');
        if (dateSaveBtn) {
          dateSaveBtn.addEventListener('click', () => {
            this.dateValue.textContent = this.selectedDate || 'Add dates';
            if (this.selectedDate) {
              this.dateValue.classList.add('has-value');
            }
            this.hideAllModals();
          });
        }
        
        // Clear button
        const dateClearBtn = document.getElementById('dateClearBtn');
        if (dateClearBtn) {
          dateClearBtn.addEventListener('click', () => {
            this.selectedDate = '';
            this.dateValue.textContent = 'Add dates';
            this.dateValue.classList.remove('has-value');
            this.hideAllModals();
          });
        }
      }
      
      // Guest modal events
      if (this.guestModal) {
        // Adult counter buttons
        const adultIncrease = document.getElementById('adultIncrease');
        const adultDecrease = document.getElementById('adultDecrease');
        
        if (adultIncrease) {
          adultIncrease.addEventListener('click', () => {
            this.guests.adults++;
            this.updateGuestCounter('adult');
          });
        }
        
        if (adultDecrease) {
          adultDecrease.addEventListener('click', () => {
            if (this.guests.adults > 0) {
              this.guests.adults--;
              this.updateGuestCounter('adult');
            }
          });
        }
        
        // Child counter buttons
        const childIncrease = document.getElementById('childIncrease');
        const childDecrease = document.getElementById('childDecrease');
        
        if (childIncrease) {
          childIncrease.addEventListener('click', () => {
            this.guests.children++;
            this.updateGuestCounter('child');
          });
        }
        
        if (childDecrease) {
          childDecrease.addEventListener('click', () => {
            if (this.guests.children > 0) {
              this.guests.children--;
              this.updateGuestCounter('child');
            }
          });
        }
        
        // Save button
        const guestSaveBtn = document.getElementById('guestSaveBtn');
        if (guestSaveBtn) {
          guestSaveBtn.addEventListener('click', () => {
            this.updateGuestDisplay();
            this.hideAllModals();
          });
        }
      }
      
      // Clicking outside to close modals
      this.modalOverlay.addEventListener('click', (e) => {
        if (e.target === this.modalOverlay) {
          this.hideAllModals();
        }
      });
      
      console.log('‚úÖ Experience search bar event listeners attached');
    }    showModal(modalType, modalData = {}) {
      // Hide any other visible modals first
      this.hideAllModals();
      
      // Set current modal type
      this.currentModalType = modalType;
      
      // Configure the modal based on type
      if (modalType === 'date') {
        this.setupDateModal();
      } else if (modalType === 'guest') {
        this.setupGuestModal();
      } else {
        console.warn('Unknown modal type:', modalType);
        return;
      }
      
      // Show the modal
      if (this.modal) {
        this.modal.style.display = 'block';
        console.log('üîç Showing modal:', modalType);
      } else {
        console.error('Modal element not found');
      }
    }setupDateModal() {
      // Set modal title
      if (this.modalTitle) {
        this.modalTitle.textContent = 'Select dates';
      }
      
      // Clear previous content
      if (this.modalBody) {
        // Get today's date for quick options
        const today = new Date();
        
        // Get tomorrow's date
        const tomorrow = new Date();
        tomorrow.setDate(today.getDate() + 1);
        
        // Get weekend (next Saturday)
        const weekend = new Date();
        weekend.setDate(today.getDate() + (6 - today.getDay()));
        
        // Create HTML for compact date picker layout
        this.modalBody.innerHTML = `
          <div class="date-picker-container">
            <div class="date-quick-options">
              <div class="quick-date-option" data-option="today">
                <div class="quick-date-title">Today</div>
                <div class="quick-date-subtitle">${this.formatDate(today)}</div>
              </div>
              <div class="quick-date-option" data-option="tomorrow">
                <div class="quick-date-title">Tomorrow</div>
                <div class="quick-date-subtitle">${this.formatDate(tomorrow)}</div>
              </div>
              <div class="quick-date-option" data-option="weekend">
                <div class="quick-date-title">Weekend</div>
                <div class="quick-date-subtitle">${this.formatDate(weekend)}</div>
              </div>             
            </div>
            <div class="calendar-container">
              <div class="calendar-header">
                <button class="calendar-nav" id="prevMonth">‚Äπ</button>
                <div class="calendar-month-year" id="monthYear">${today.toLocaleDateString('en-US', { month: 'long', year: 'numeric' })}</div>
                <button class="calendar-nav" id="nextMonth">‚Ä∫</button>
              </div>
              <div id="datepickerContainer" class="flatpickr-container"></div>
            </div>
          </div>
        `;
        
        // Initialize flatpickr in the container
        const datepickerContainer = document.getElementById('datepickerContainer');
        if (window.flatpickr && datepickerContainer) {
          if (this.calendar) {
            // Destroy previous instance if exists
            this.calendar.destroy();
          }
          
          this.calendar = flatpickr(datepickerContainer, {
            mode: "single",
            dateFormat: "Y-m-d",
            minDate: "today",
            inline: true,
            onChange: (selectedDates, dateStr) => {
              if (selectedDates.length > 0) {
                this.selectedDate = this.formatDate(selectedDates[0]);
                console.log('Calendar date selected:', this.selectedDate);
                
                // Auto-close after selection with a small delay for better UX
                setTimeout(() => {
                  if (this.dateValue) {
                    this.dateValue.textContent = this.selectedDate;
                    this.dateValue.classList.add('has-value');
                  }
                  this.hideAllModals();
                }, 500);
              }
            }
          });
        } else {
          this.modalBody.innerHTML = '<p class="error-message">Date picker not available</p>';
        }
        
        // Add event listeners to quick date options
        const quickDateOptions = this.modalBody.querySelectorAll('.quick-date-option');
        quickDateOptions.forEach(option => {
          option.addEventListener('click', () => {
            const dateOption = option.dataset.option;
            
            // Remove selected class from all options
            quickDateOptions.forEach(o => o.classList.remove('selected'));
            
            // Add selected class to clicked option
            option.classList.add('selected');
            
            // Handle date selection based on option
            this.selectDateOption(dateOption);
            
            // Auto-close after selection with a small delay for better UX
            setTimeout(() => {
              if (this.dateValue) {
                this.dateValue.textContent = this.selectedDate;
                this.dateValue.classList.add('has-value');
              }
              this.hideAllModals();
            }, 300);
          });
        });
      }
      
      // Set confirm button action
      if (this.confirmBtn) {
        this.confirmBtn.textContent = 'Select Date';
        this.confirmBtn.onclick = () => {
          if (this.selectedDate && this.dateValue) {
            this.dateValue.textContent = this.selectedDate;
            this.dateValue.classList.add('has-value');
          } else if (this.dateValue) {
            this.dateValue.textContent = 'Add dates';
            this.dateValue.classList.remove('has-value');
          }
          this.hideAllModals();
        };
      }
    }    setupGuestModal() {
      // Set modal title
      if (this.modalTitle) {
        this.modalTitle.textContent = 'Add guests';
      }
      
      // Create guest counter HTML with compact design
      if (this.modalBody) {
        this.modalBody.innerHTML = `
          <div class="guest-counter-container">
            <div class="guest-type-row">
              <div class="guest-type">
                <h3>Adults</h3>
                <p>Ages 13 or above</p>
              </div>
              <div class="guest-count-controls">
                <button id="adultDecrease" class="count-btn decrease" ${this.guests.adults <= 0 ? 'disabled' : ''}>-</button>
                <span id="adultCount" class="guest-count">${this.guests.adults}</span>
                <button id="adultIncrease" class="count-btn increase">+</button>
              </div>
            </div>
            <div class="guest-type-row">
              <div class="guest-type">
                <h3>Children</h3>
                <p>Ages 2-12</p>
              </div>
              <div class="guest-count-controls">
                <button id="childDecrease" class="count-btn decrease" ${this.guests.children <= 0 ? 'disabled' : ''}>-</button>
                <span id="childCount" class="guest-count">${this.guests.children}</span>
                <button id="childIncrease" class="count-btn increase">+</button>
              </div>
            </div>
          </div>
        `;
        
        // Attach event listeners to the guest counter buttons
        const adultIncreaseBtn = document.getElementById('adultIncrease');
        if (adultIncreaseBtn) {
          adultIncreaseBtn.addEventListener('click', () => {
            this.guests.adults++;
            this.updateGuestCounter('adult');
          });
        }
        
        const adultDecreaseBtn = document.getElementById('adultDecrease');
        if (adultDecreaseBtn) {
          adultDecreaseBtn.addEventListener('click', () => {
            if (this.guests.adults > 0) {
              this.guests.adults--;
              this.updateGuestCounter('adult');
            }
          });
        }
        
        const childIncreaseBtn = document.getElementById('childIncrease');
        if (childIncreaseBtn) {
          childIncreaseBtn.addEventListener('click', () => {
            this.guests.children++;
            this.updateGuestCounter('child');
          });
        }
        
        const childDecreaseBtn = document.getElementById('childDecrease');
        if (childDecreaseBtn) {
          childDecreaseBtn.addEventListener('click', () => {
            if (this.guests.children > 0) {
              this.guests.children--;
              this.updateGuestCounter('child');
            }
          });
        }
      }
      
      // Set confirm button action
      if (this.confirmBtn) {
        this.confirmBtn.textContent = 'Save';
        this.confirmBtn.onclick = () => {
          this.updateGuestDisplay();
          this.hideAllModals();
        };
      }
    }
      hideAllModals() {
      // Hide the new unified modal
      if (this.modal) {
        this.modal.style.display = 'none';
        this.currentModalType = null;
      }
      
      // For backward compatibility, also hide old modals
      if (this.modalOverlay) {
        this.modalOverlay.classList.remove('visible');
      }
      
      // Hide all legacy modals
      const modals = document.querySelectorAll('.experience-modal');
      modals.forEach(modal => {
        modal.classList.remove('visible');
      });
      
      console.log('üîç All modals hidden');
    }
      updateGuestCounter(type) {
      const countElement = document.getElementById(`${type}Count`);
      const decrementButton = document.getElementById(`${type}Decrease`);
      
      if (countElement) {
        countElement.textContent = this.guests[type + 's']; // Add 's' to match the property name
      }
      
      if (decrementButton) {
        decrementButton.disabled = this.guests[type + 's'] <= 0;
      }
      
      // Also update the guest display
      this.updateGuestDisplay();
    }
    
    updateGuestDisplay() {
      if (!this.guestValue) return;
      
      const totalGuests = this.guests.adults + this.guests.children;
      
      if (totalGuests === 0) {
        this.guestValue.textContent = 'Add guests';
        this.guestValue.classList.remove('has-value');
      } else {
        let displayText = totalGuests === 1 ? '1 guest' : `${totalGuests} guests`;
        this.guestValue.textContent = displayText;
        this.guestValue.classList.add('has-value');
      }
    }
    
    selectDateOption(dateType) {
      let selectedDate = '';
      
      const today = new Date();
      
      switch(dateType) {
        case 'today':
          selectedDate = this.formatDate(today);
          break;
        case 'tomorrow':
          const tomorrow = new Date();
          tomorrow.setDate(today.getDate() + 1);
          selectedDate = this.formatDate(tomorrow);
          break;
        case 'weekend':
          const thisWeekend = new Date();
          // Find next Saturday
          thisWeekend.setDate(today.getDate() + (6 - today.getDay()));
          selectedDate = this.formatDate(thisWeekend);
          break;
        case 'nextWeek':
          const nextWeek = new Date();
          nextWeek.setDate(today.getDate() + 7);
          selectedDate = this.formatDate(nextWeek);
          break;
        case 'nextMonth':
          const nextMonth = new Date();
          nextMonth.setMonth(today.getMonth() + 1);
          selectedDate = this.formatDate(nextMonth);
          break;
        case 'flexible':
          // Just open the calendar without setting a date
          break;
      }
      
      if (selectedDate) {
        this.selectedDate = selectedDate;
        console.log('üìÖ Selected date option:', dateType, selectedDate);
      }
    }
      formatDate(date) {
      const options = { weekday: 'short', month: 'short', day: 'numeric' };
      return date.toLocaleDateString('en-US', options);
    }
    
    initDateOptions() {
      // Set up the date options with current dates
      const today = new Date();
      
      // Format and display today's date
      const todayEl = document.getElementById('todayDate');
      if (todayEl) {
        todayEl.textContent = this.formatDate(today);
      }
      
      // Tomorrow
      const tomorrow = new Date();
      tomorrow.setDate(today.getDate() + 1);
      const tomorrowEl = document.getElementById('tomorrowDate');
      if (tomorrowEl) {
        tomorrowEl.textContent = this.formatDate(tomorrow);
      }
      
      // Weekend (next Saturday)
      const weekend = new Date();
      weekend.setDate(today.getDate() + (6 - today.getDay()));
      const weekendEl = document.getElementById('weekendDate');
      if (weekendEl) {
        weekendEl.textContent = this.formatDate(weekend);
      }
      
      // Next week (7 days from now)
      const nextWeek = new Date();
      nextWeek.setDate(today.getDate() + 7);
      const nextWeekEl = document.getElementById('nextWeekDate');
      if (nextWeekEl) {
        nextWeekEl.textContent = this.formatDate(nextWeek);
      }
      
      // Next month
      const nextMonth = new Date();
      nextMonth.setMonth(today.getMonth() + 1);
      const nextMonthEl = document.getElementById('nextMonthDate');
      if (nextMonthEl) {
        nextMonthEl.textContent = this.formatDate(nextMonth);
      }
      
      console.log('‚úÖ Date options initialized');
    }
    
    initCalendar() {
      // Initialize the flatpickr calendar if available
      const calendarContainer = document.getElementById('experienceCalendar');
      
      if (calendarContainer && window.flatpickr) {
        this.calendar = flatpickr(calendarContainer, {
          inline: true,
          minDate: 'today',
          dateFormat: 'Y-m-d',
          onChange: (selectedDates, dateStr) => {
            if (selectedDates.length > 0) {
              this.selectedDate = this.formatDate(selectedDates[0]);
              console.log('Calendar date selected:', this.selectedDate);
            }
          }
        });
        console.log('‚úÖ Calendar initialized');
      } else {
        console.log('‚ö†Ô∏è Flatpickr not available or calendar container not found');
      }
    }
  }
</script>

<!-- Experience Search Bar Modal System - Compact Design -->
<div id="modal" class="modal">
    <div class="modal-content">
        <span class="close" id="closeModal">&times;</span>
        <h2 id="modalTitle">Modal Title</h2>
        <div id="modalBody">
            <!-- Modal content will be dynamically inserted here -->
        </div>
        <div class="modal-footer">
            <button id="confirmSelection" class="confirm-btn">Save</button>
        </div>
    </div>
</div>

  </body>
</html>

