<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Trip Summary</title>
    <link rel="stylesheet" href="style.css">
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://maps.googleapis.com/maps/api/js?key=AIzaSyAd_O4s_73E_A8rq7TGCHKVEBFHzNecAHM&libraries=places" async defer></script>
  </head>
  <body class="bg-gray-100">
    <main class="flex items-center justify-center min-h-screen py-8">
      <div class="max-w-2xl mx-auto bg-white rounded-lg shadow-md p-6 w-full">
        <!-- Map Section -->
        <div id="map" class="w-full h-64 rounded-lg mb-6 border border-gray-200"></div>
        
        <!-- Trip Details Section -->
        <h1 class="text-2xl font-bold text-gray-900 mb-4">Trip Summary</h1>
        <div id="summary-details" class="space-y-2 mb-6">
          <!-- Trip details will be dynamically populated here -->
        </div>
        
        <!-- Included Benefits Section -->
        <div class="mb-6">
          <h2 class="text-xl font-semibold text-gray-800 mb-3">Includes:</h2>
          <ul class="space-y-2 text-gray-700">
            <li class="flex items-start">
              <svg class="h-5 w-5 text-green-500 mr-2 mt-0.5" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor">
                <path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z" clip-rule="evenodd" />
              </svg>
              Free cancellation up to 1hr before
            </li>
            <li class="flex items-start">
              <svg class="h-5 w-5 text-green-500 mr-2 mt-0.5" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor">
                <path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z" clip-rule="evenodd" />
              </svg>
              Free 15 minutes wait time
            </li>
            <li class="flex items-start">
              <svg class="h-5 w-5 text-green-500 mr-2 mt-0.5" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor">
                <path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z" clip-rule="evenodd" />
              </svg>
              Complimentary WiFi
            </li>
            <li class="flex items-start">
              <svg class="h-5 w-5 text-green-500 mr-2 mt-0.5" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor">
                <path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z" clip-rule="evenodd" />
              </svg>
              Tissues & sanitizer
            </li>
            <li class="flex items-start">
              <svg class="h-5 w-5 text-green-500 mr-2 mt-0.5" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor">
                <path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z" clip-rule="evenodd" />
              </svg>
              Complimentary bottle of water
            </li>
            <li class="flex items-start">
              <svg class="h-5 w-5 text-green-500 mr-2 mt-0.5" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor">
                <path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z" clip-rule="evenodd" />
              </svg>
              Apple & Android chargers
            </li>
            <li class="flex items-start">
              <svg class="h-5 w-5 text-green-500 mr-2 mt-0.5" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor">
                <path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z" clip-rule="evenodd" />
              </svg>
              Entertainment package
            </li>
            <li class="flex items-start">
              <svg class="h-5 w-5 text-green-500 mr-2 mt-0.5" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor">
                <path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z" clip-rule="evenodd" />
              </svg>
              Only top drivers
            </li>
          </ul>
        </div>
          <!-- Book Now Button -->
        <button id="book-now-button" class="mt-6 w-full bg-[--color-gold] text-white py-3 rounded-lg font-semibold hover:bg-[--color-gold-dark]">
          Book Now
        </button>
        
        <!-- Back Button -->
        <button onclick="window.history.back()" class="mt-3 w-full bg-gray-200 text-gray-800 py-3 rounded-lg font-semibold hover:bg-gray-300">
          Back to Booking
        </button>
      </div>
    </main>
    <script>
      document.addEventListener('DOMContentLoaded', () => {        const params = new URLSearchParams(window.location.search);
        const summaryDetails = document.getElementById('summary-details');
        const bookNowButton = document.getElementById('book-now-button');
        let map;
        let directionsService;
        let directionsRenderer;
        
        // Trip details
        const tripDetails = {
          'From': params.get('from'),
          'To': params.get('to'),
          'Booking Preference': params.get('preference') || 'ASAP',
        };
        
        // Add date and time if booking preference is Scheduled
        if (tripDetails['Booking Preference'] === 'Scheduled') {
          tripDetails['Pickup Date'] = params.get('date') || 'N/A';
          tripDetails['Pickup Time'] = params.get('time') || 'N/A';
        }
        
        // Calculate estimated arrival and distance
        const estimatedArrival = new Date();
        estimatedArrival.setHours(estimatedArrival.getHours() + 1);
        const formattedTime = estimatedArrival.toLocaleTimeString([], { hour: '2-digit', minute: '2-digit' });
        
        tripDetails['Estimated Arrival'] = formattedTime;
        
        // Populate trip details
        for (const [key, value] of Object.entries(tripDetails)) {
          const detail = document.createElement('p');
          detail.innerHTML = `<strong>${key}:</strong> ${value || 'N/A'}`;
          summaryDetails.appendChild(detail);
        }
        
        // Initialize map
        function initMap() {
          directionsService = new google.maps.DirectionsService();
          directionsRenderer = new google.maps.DirectionsRenderer();
          
          map = new google.maps.Map(document.getElementById('map'), {
            zoom: 12,
            center: { lat: 25.7617, lng: -80.1918 }, // Miami coordinates
            mapTypeControl: false,
            streetViewControl: false,
            fullscreenControl: false
          });
          
          directionsRenderer.setMap(map);
          
          // Calculate and display route if both from and to are provided
          if (tripDetails['From'] && tripDetails['To']) {
            calculateAndDisplayRoute();
          }
        }
        
        function calculateAndDisplayRoute() {
          directionsService.route(
            {
              origin: tripDetails['From'],
              destination: tripDetails['To'],
              travelMode: google.maps.TravelMode.DRIVING,
            },
            (response, status) => {
              if (status === "OK") {
                directionsRenderer.setDirections(response);
                
                // Get distance and duration
                const route = response.routes[0];
                const leg = route.legs[0];
                
                // Add distance to trip details
                const distanceDetail = document.createElement('p');
                distanceDetail.innerHTML = `<strong>Distance:</strong> ${leg.distance.text}`;
                summaryDetails.appendChild(distanceDetail);
              } else {
                console.error("Directions request failed due to " + status);
              }
            }
          );
        }
          // Book Now button functionality
        bookNowButton.addEventListener('click', () => {
          // Here you would typically submit the booking to your backend
          alert('Booking successful! A confirmation will be sent to your email.');
          
          // For demo purposes, you could redirect to a confirmation page
          // window.location.href = 'confirmation.html';
        });
        
        // Initialize Google Maps when API is loaded
        window.initMap = initMap;
        
        // If Google Maps API is already loaded, initialize the map
        if (window.google && window.google.maps) {
          initMap();
        }
      });
    </script>
  </body>
</html>
